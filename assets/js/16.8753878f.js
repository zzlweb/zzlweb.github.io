(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{579:function(s,n,a){"use strict";a.r(n);var e=a(10),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"}),a("p",[s._v("MongoDB 基础教程以及进阶使用")])]),s._v(" "),a("h2",{attrs:{id:"mongodb-安装教程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-安装教程"}},[s._v("#")]),s._v(" MongoDB 安装教程")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.mongodb.com/try/download/community",target:"_blank",rel:"noopener noreferrer"}},[s._v("MongoDB 官网"),a("OutboundLink")],1)]),s._v(" "),a("blockquote",[a("p",[s._v("一般下载的为社区版 社区版为个人学习使用，免费。")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/mongodb/home.png",alt:""}})]),s._v(" "),a("p",[s._v("下载完之后 双击 msi 文件开始安装")]),s._v(" "),a("blockquote",[a("p",[s._v("下一步")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/mongodb/step1.png",alt:""}})]),s._v(" "),a("blockquote",[a("p",[s._v("勾选协议")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/mongodb/step2.png",alt:""}})]),s._v(" "),a("blockquote",[a("p",[s._v("选择安装方式")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/mongodb/step3.png",alt:""}})]),s._v(" "),a("blockquote",[a("p",[s._v("选择安装地址")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/mongodb/step4.png",alt:""}})]),s._v(" "),a("blockquote",[a("p",[s._v("选择数据库以及日志存放地址")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/mongodb/step5.png",alt:""}})]),s._v(" "),a("blockquote",[a("p",[s._v("选择是否安装图形可视化工具")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/mongodb/step6.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"配置环境变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置环境变量"}},[s._v("#")]),s._v(" 配置环境变量")]),s._v(" "),a("p",[s._v("进入 MongoDB 文件夹的 bin 文件夹 并复制其路径")]),s._v(" "),a("p",[a("img",{attrs:{src:"/mongodb/step7.png",alt:""}})]),s._v(" "),a("p",[s._v("在系统 Path 中添加路径")]),s._v(" "),a("p",[a("img",{attrs:{src:"/mongodb/step8.png",alt:""}})]),s._v(" "),a("blockquote",[a("p",[s._v("配置完成后，重启电脑，环境变量才会生效。")])]),s._v(" "),a("blockquote",[a("p",[s._v("打开 CMD 命令页面，直接输入 mongo 可进入客户端\n"),a("img",{attrs:{src:"/mongodb/step9.png",alt:""}})])]),s._v(" "),a("h2",{attrs:{id:"什么是-mongodb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是-mongodb"}},[s._v("#")]),s._v(" 什么是 MongoDB ?")]),s._v(" "),a("p",[s._v("MongoDB 是由 C++语言编写的，是一个基于分布式文件存储的开源数据库系统。")]),s._v(" "),a("p",[s._v("在高负载的情况下，添加更多的节点，可以保证服务器性能。")]),s._v(" "),a("p",[s._v("MongoDB 旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。")]),s._v(" "),a("p",[s._v("MongoDB 将数据存储为一个文档，数据结构由键值(key=>value)对组成。MongoDB 文档类似于 JSON 对象。字段值可以包含其他文档，数组及文档数组。")]),s._v(" "),a("h2",{attrs:{id:"mongodb-概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-概念"}},[s._v("#")]),s._v(" MongoDB 概念")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("SQL 术语/概念")]),s._v(" "),a("th",[s._v("MongoDB 术语/概念")]),s._v(" "),a("th",[s._v("解释/说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("database")]),s._v(" "),a("td",[s._v("database")]),s._v(" "),a("td",[s._v("数据库")])]),s._v(" "),a("tr",[a("td",[s._v("table")]),s._v(" "),a("td",[s._v("collection")]),s._v(" "),a("td",[s._v("数据库表/集合")])]),s._v(" "),a("tr",[a("td",[s._v("row")]),s._v(" "),a("td",[s._v("document")]),s._v(" "),a("td",[s._v("数据记录行/文档")])]),s._v(" "),a("tr",[a("td",[s._v("column")]),s._v(" "),a("td",[s._v("field")]),s._v(" "),a("td",[s._v("数据字段/域")])]),s._v(" "),a("tr",[a("td",[s._v("index")]),s._v(" "),a("td",[s._v("index")]),s._v(" "),a("td",[s._v("索引")])]),s._v(" "),a("tr",[a("td",[s._v("table")]),s._v(" "),a("td",[s._v("joins")]),s._v(" "),a("td",[s._v("表连接,MongoDB 不支持")])]),s._v(" "),a("tr",[a("td",[s._v("primary key")]),s._v(" "),a("td",[s._v("primary key")]),s._v(" "),a("td",[s._v("主键,MongoDB 自动将_id 字段设置为主键")])])])]),s._v(" "),a("p",[s._v("在向 mongodb 的同一个表中插入数据的时候，插入的数据字段类型可以不一样，即使是相同的字段数据类型也可以不一样。但是不建议这样做，应该提前考虑好数据库应有的字段，同事每一个字段应该使用同一种数据类型。")]),s._v(" "),a("h2",{attrs:{id:"mongodb-后台管理-shell"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-后台管理-shell"}},[s._v("#")]),s._v(" MongoDB 后台管理 Shell")]),s._v(" "),a("p",[s._v("如果你需要进入 MongoDB 后台管理，你需要先打开 mongodb 装目录的下的 bin 目录，然后执行 mongo.exe 文件，MongoDB Shell 是 MongoDB 自带的交互式 Javascript shell,用来对 MongoDB 进行操作和管理的交互式环境。")]),s._v(" "),a("p",[s._v("当你进入 mongoDB 后台后，它默认会链接到 test 文档（数据库）：")]),s._v(" "),a("h2",{attrs:{id:"数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据库"}},[s._v("#")]),s._v(" 数据库")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("一个 mongodb 中可以建立多个数据库。")])]),s._v(" "),a("li",[a("p",[s._v('MongoDB 的默认数据库为"db"，该数据库存储在 data 目录中。')])]),s._v(" "),a("li",[a("p",[s._v("MongoDB 的单个实例可以容纳多个独立的数据库，每一个都有自己的集合和权限，不同的数据库也放置在不同的文件中。")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("show dbs")]),s._v(" 命令可以显示所有数据的列表。")])])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" > show dbs\n  admin   0.000GB\n  config  0.000GB\n  local   0.000GB\n  test    0.000GB\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("执行 "),a("strong",[s._v("db")]),s._v(" 命令可以显示当前数据库对象或集合。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" > db\ntest\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("数据库也通过名字来标识。数据库名可以是满足以下条件的任意 UTF-8 字符串。")]),s._v(" "),a("ul",[a("li",[s._v('不能是空字符串（"")。')]),s._v(" "),a("li",[s._v("不得含有' '（空格)、.、$、/、\\和\\0 (空字符)。")]),s._v(" "),a("li",[s._v("应全部小写。")]),s._v(" "),a("li",[s._v("最多 64 字节。")])]),s._v(" "),a("p",[s._v("有一些数据库名是保留的，可以直接访问这些有特殊作用的数据库。")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("admin")]),s._v('： 从权限的角度来看，这是"root"数据库。要是将一个用户添加到这个数据库，这个用户自动继承所有数据库的权限。一些特定的服务器端命令也只能从这个数据库运行，比如列出所有的数据库或者关闭服务器。')]),s._v(" "),a("li",[a("strong",[s._v("local")]),s._v(": 这个数据永远不会被复制，可以用来存储限于本地单台服务器的任意集合")]),s._v(" "),a("li",[a("strong",[s._v("config")]),s._v(": 当 Mongo 用于分片设置时，config 数据库在内部使用，用于保存分片的相关信息。")])]),s._v(" "),a("h2",{attrs:{id:"文档-document"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文档-document"}},[s._v("#")]),s._v(" 文档(Document)")]),s._v(" "),a("p",[s._v("文档是一组键值(key-value)对(即 BSON)。MongoDB 的文档不需要设置相同的字段，并且相同的字段不需要相同的数据类型，这与关系型数据库有很大的区别，也是 MongoDB 非常突出的特点。")]),s._v(" "),a("p",[s._v("一个简单的文档例子如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('{"site":"10.8.104.7", "name":"zzl"}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("下表列出了 RDBMS 与 MongoDB 对应的术语：")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("RDBMS")]),s._v(" "),a("th",[s._v("MongoDB")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("数据库")]),s._v(" "),a("td",[s._v("数据库")])]),s._v(" "),a("tr",[a("td",[s._v("表格")]),s._v(" "),a("td",[s._v("集合")])]),s._v(" "),a("tr",[a("td",[s._v("行")]),s._v(" "),a("td",[s._v("文档")])]),s._v(" "),a("tr",[a("td",[s._v("列")]),s._v(" "),a("td",[s._v("字段")])]),s._v(" "),a("tr",[a("td",[s._v("表联合")]),s._v(" "),a("td",[s._v("嵌入文档")])]),s._v(" "),a("tr",[a("td",[s._v("主键")]),s._v(" "),a("td",[s._v("主键 (MongoDB 提供了 key 为 _id )")])])])]),s._v(" "),a("table",[a("tr",[a("th",{attrs:{colspan:"2"}},[s._v("数据库服务和客户端")])]),s._v(" "),a("tr",[a("td",[s._v("Mysqld/Oracle")]),s._v(" "),a("td",[s._v("mongod")])]),s._v(" "),a("tr",[a("td",[s._v("mysql/sqlplus")]),s._v(" "),a("td",[s._v("mongo")])])]),s._v(" "),a("p",[s._v("需要注意的是：")]),s._v(" "),a("ol",[a("li",[s._v("文档中的键/值对是有序的。")]),s._v(" "),a("li",[s._v("文档中的值不仅可以是在双引号里面的字符串，还可以是其他几种数据类型（甚至可以是整个嵌入的文档)。")]),s._v(" "),a("li",[s._v("MongoDB 区分类型和大小写。")]),s._v(" "),a("li",[s._v("MongoDB 的文档不能有重复的键。 5.文档的键是字符串。除了少数例外情况，键可以使用任意 UTF-8 字符。\n文档键命名规范：")])]),s._v(" "),a("ul",[a("li",[s._v("键不能含有\\0 (空字符)。这个字符用来表示键的结尾。")]),s._v(" "),a("li",[s._v(".和$有特别的意义，只有在特定环境下才能使用。")]),s._v(" "),a("li",[s._v('以下划线"_"开头的键是保留的(不是严格要求的)。')])]),s._v(" "),a("h2",{attrs:{id:"集合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集合"}},[s._v("#")]),s._v(" 集合")]),s._v(" "),a("p",[s._v("集合就是 MongoDB 文档组，类似于 RDBMS （关系数据库管理系统：Relational Database Management System)中的表格。")]),s._v(" "),a("p",[s._v("集合存在于数据库中，集合没有固定的结构，这意味着你在对集合可以插入不同格式和类型的数据，但通常情况下我们插入集合的数据都会有一定的关联性。")]),s._v(" "),a("p",[s._v("比如，我们可以将以下不同数据结构的文档插入到集合中：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('{"site":"www.baidu.com"}\n{"site":"www.google.com","name":"Google"}\n{"site":"www.runoob.com","name":"菜鸟教程","num":5}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("当第一个文档插入时，集合就会被创建。")]),s._v(" "),a("h2",{attrs:{id:"合法的集合名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#合法的集合名"}},[s._v("#")]),s._v(" 合法的集合名")]),s._v(" "),a("ul",[a("li",[s._v('集合名不能是空字符串""。')]),s._v(" "),a("li",[s._v("集合名不能含有\\0 字符（空字符)，这个字符表示集合名的结尾。")]),s._v(" "),a("li",[s._v('集合名不能以"system."开头，这是为系统集合保留的前缀。')]),s._v(" "),a("li",[s._v("用户创建的集合名字不能含有保留字符。有些驱动程序的确支持在集合名里面包含，这是因为某些系统生成的集合中包含该字符。除非你要访问这种系统创建的集合，否则千万不要在名字里出现$。")])]),s._v(" "),a("h2",{attrs:{id:"元数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#元数据"}},[s._v("#")]),s._v(" 元数据")]),s._v(" "),a("p",[s._v("数据库的信息是存储在集合中。它们使用了系统的命名空间：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("dbname.system.*\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("在 MongoDB 数据库中名字空间 "),a("code",[s._v("<dbname>.system.*")]),s._v(" 是包含多种系统信息的特殊集合(Collection)，如下:")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("集合命名空间")]),s._v(" "),a("th",[s._v("描述")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[a("code",[s._v("dbname.system.namespaces")])]),s._v(" "),a("td",[s._v("列出所有名字空间。")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("dbname.system.indexes")])]),s._v(" "),a("td",[s._v("列出所有索引。")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("dbname.system.profile")])]),s._v(" "),a("td",[s._v("包含数据库概要("),a("code",[s._v("profile")]),s._v(")信息。")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("dbname.system.users")])]),s._v(" "),a("td",[s._v("列出所有可访问数据库的用户。")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("dbname.local.sources")])]),s._v(" "),a("td",[a("code",[s._v("包含复制对端（slave）的服务器信息和状态。")])])])])]),s._v(" "),a("p",[s._v("对于修改系统集合中的对象有如下限制。")]),s._v(" "),a("p",[s._v("在"),a("code",[s._v("system.indexes")]),s._v("插入数据，可以创建索引。但除此之外该表信息是不可变的(特殊的 drop index 命令将自动更新相关信息)。")]),s._v(" "),a("p",[a("code",[s._v("system.users")]),s._v("是可修改的。 "),a("code",[s._v("system.profile")]),s._v("是可删除的。")]),s._v(" "),a("h2",{attrs:{id:"mongodb-数据类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-数据类型"}},[s._v("#")]),s._v(" MongoDB 数据类型")]),s._v(" "),a("p",[s._v("下表为 MongoDB 中常用的几种数据类型。")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("数据类型")]),s._v(" "),a("th",[s._v("描述")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("String")]),s._v(" "),a("td",[s._v("字符串。存储数据常用的数据类型。在 MongoDB 中，UTF-8 编码的字符串才是合法的。")])]),s._v(" "),a("tr",[a("td",[s._v("Integer")]),s._v(" "),a("td",[s._v("整型数值。用于存储数值。根据你所采用的服务器，可分为 32 位或 64 位。")])]),s._v(" "),a("tr",[a("td",[s._v("Boolean")]),s._v(" "),a("td",[s._v("布尔值。用于存储布尔值（真/假）。")])]),s._v(" "),a("tr",[a("td",[s._v("Double")]),s._v(" "),a("td",[s._v("双精度浮点值。用于存储浮点值。")])]),s._v(" "),a("tr",[a("td",[s._v("Min/Max keys")]),s._v(" "),a("td",[s._v("将一个值与 BSON（二进制的 JSON）元素的最低值和最高值相对比。")])]),s._v(" "),a("tr",[a("td",[s._v("Array")]),s._v(" "),a("td",[s._v("用于将数组或列表或多个值存储为一个键。")])]),s._v(" "),a("tr",[a("td",[s._v("Timestamp")]),s._v(" "),a("td",[s._v("时间戳。记录文档修改或添加的具体时间。")])]),s._v(" "),a("tr",[a("td",[s._v("Object")]),s._v(" "),a("td",[s._v("用于内嵌文档。")])]),s._v(" "),a("tr",[a("td",[s._v("Null")]),s._v(" "),a("td",[s._v("用于创建空值。")])]),s._v(" "),a("tr",[a("td",[s._v("Symbol")]),s._v(" "),a("td",[s._v("符号。该数据类型基本上等同于字符串类型，但不同的是，它一般用于采用特殊符号类型的语言。")])]),s._v(" "),a("tr",[a("td",[s._v("Date")]),s._v(" "),a("td",[s._v("日期时间。用 UNIX 时间格式来存储当前日期或时间。你可以指定自己的日期时间：创建 Date 对象，传入年月日信息。")])]),s._v(" "),a("tr",[a("td",[s._v("Object ID")]),s._v(" "),a("td",[s._v("对象 ID。用于创建文档的 ID。")])]),s._v(" "),a("tr",[a("td",[s._v("Binary Data")]),s._v(" "),a("td",[s._v("二进制数据。用于存储二进制数据。")])]),s._v(" "),a("tr",[a("td",[s._v("Code")]),s._v(" "),a("td",[s._v("代码类型。用于在文档中存储 JavaScript 代码。")])]),s._v(" "),a("tr",[a("td",[s._v("Regular expression")]),s._v(" "),a("td",[s._v("正则表达式类型。用于存储正则表达式。")])])])]),s._v(" "),a("p",[s._v("下面说明下几种重要的数据类型。")]),s._v(" "),a("h2",{attrs:{id:"objectid"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#objectid"}},[s._v("#")]),s._v(" ObjectId")]),s._v(" "),a("p",[s._v("ObjectId 类似唯一主键，可以很快的去生成和排序，包含 12 bytes，含义是：")]),s._v(" "),a("ul",[a("li",[s._v("前 4 个字节表示创建 unix 时间戳,格林尼治时间 UTC 时间，比北京时间晚了 8 个小时")]),s._v(" "),a("li",[s._v("接下来的 3 个字节是机器标识码")]),s._v(" "),a("li",[s._v("紧接的两个字节由进程 id 组成 PID")]),s._v(" "),a("li",[s._v("最后三个字节是随机数")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/mongodb/objectid.jpeg",alt:""}})]),s._v(" "),a("p",[s._v("MongoDB 中存储的文档必须有一个 _id 键。这个键的值可以是任何类型的，默认是个 ObjectId 对象")]),s._v(" "),a("p",[s._v("由于 ObjectId 中保存了创建的时间戳，所以你不需要为你的文档保存时间戳字段，你可以通过 getTimestamp 函数来获取文档的创建时间:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> var newObject = ObjectId()\n> newObject.getTimestamp()\nISODate("2017-11-25T07:21:10Z")\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("ObjectId 转为字符串")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("> newObject.str\n5a1919e63df83ce79df8b38f\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"字符串"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#字符串"}},[s._v("#")]),s._v(" 字符串")]),s._v(" "),a("p",[a("strong",[s._v("BSON 字符串都是 UTF-8 编码。")])]),s._v(" "),a("h2",{attrs:{id:"时间戳"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#时间戳"}},[s._v("#")]),s._v(" 时间戳")]),s._v(" "),a("p",[s._v("BSON 有一个特殊的时间戳类型用于 MongoDB 内部使用，与普通的 日期 类型不相关。 时间戳值是一个 64 位的值。其中：")]),s._v(" "),a("ul",[a("li",[s._v("前 32 位是一个 time_t 值（与 Unix 新纪元相差的秒数）")]),s._v(" "),a("li",[s._v("后 32 位是在某秒中操作的一个递增的序数\n在单个 mongod 实例中，时间戳值通常是唯一的。")])]),s._v(" "),a("p",[s._v("在复制集中， oplog 有一个 ts 字段。这个字段中的值使用 BSON 时间戳表示了操作时间。")]),s._v(" "),a("blockquote",[a("p",[a("em",[s._v("BSON 时间戳类型主要用于 MongoDB 内部使用。在大多数情况下的应用开发中，你可以使用 BSON 日期类型。")])])]),s._v(" "),a("h2",{attrs:{id:"日期"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#日期"}},[s._v("#")]),s._v(" 日期")]),s._v(" "),a("p",[s._v("表示当前距离 Unix 新纪元（1970 年 1 月 1 日）的毫秒数。日期类型是有符号的, 负数表示 1970 年之前的日期。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> var mydate1 = new Date()     //格林尼治时间\n> mydate1\nISODate("2018-03-04T14:58:51.233Z")\n> typeof mydate1\nobject\n> var mydate2 = ISODate() //格林尼治时间\n> mydate2\nISODate("2018-03-04T15:00:45.479Z")\n> typeof mydate2\nobject\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("这样创建的时间是日期类型，可以使用 JS 中的 Date 类型的方法。")]),s._v(" "),a("p",[s._v("返回一个时间类型的字符串：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("> var mydate1str = mydate1.toString()\n> mydate1str\nSun Mar 04 2018 14:58:51 GMT+0000 (UTC)\n> typeof mydate1str\nstring\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("或者")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("> Date()\nSun Mar 04 2018 15:02:59 GMT+0000 (UTC)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"默认端口上的本地-mongodb-实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#默认端口上的本地-mongodb-实例"}},[s._v("#")]),s._v(" 默认端口上的本地 MongoDB 实例")]),s._v(" "),a("p",[s._v("您可以在不使用任何命令行选项的情况下运行 MongoShell，以连接到本地主机上运行的 MongoDB 实例（默认端口为 27017）:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mongo\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"非默认端口上的本地-mongodb-实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#非默认端口上的本地-mongodb-实例"}},[s._v("#")]),s._v(" 非默认端口上的本地 MongoDB 实例")]),s._v(" "),a("p",[s._v("要显式指定端口，请包括--port 命令行选项。例如，使用非默认端口 28015 连接到本地主机上运行的 MongoDB 实例:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mongo --port 28015\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"远程主机上的-mongodb-实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#远程主机上的-mongodb-实例"}},[s._v("#")]),s._v(" 远程主机上的 MongoDB 实例")]),s._v(" "),a("p",[s._v("要明确指定主机名和/或端口，")]),s._v(" "),a("ul",[a("li",[s._v("可以指定连接字符串。例如，要连接到在远程主机上运行的 MongoDB 实例：")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('mongo "mongodb://mongodb0.example.com:28015"\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("可以使用命令行选项--host "),a("code",[s._v("<host>:<port>")]),s._v("。例如，要连接到在远程主机上运行的 MongoDB 实例：")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mongo --host mongodb0.example.com:28015\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("可以使用--host "),a("code",[s._v("<host>")]),s._v("和 --port "),a("code",[s._v("<port>")]),s._v("命令行选项。例如，要连接到在远程主机上运行的 MongoDB 实例：")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mongo --host mongodb0.example.com --port 28015\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("远程主机上默认端口的 MongoDB 实例")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mongo 10.8.104.7\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("连接本地数据库服务器，端口是默认的。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mongodb://localhost\n// 或者\n\nmongo\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("使用用户名 fred，密码 foobar 登录 localhost 的 admin 数据库。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mongodb://fred:foobar@localhost\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("使用用户名 fred，密码 foobar 登录 localhost 的 baz 数据库。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mongodb://fred:foobar@localhost/baz\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("连接 replica pair, 服务器 1 为 example1.com 服务器 2 为 example2。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mongodb://example1.com:27017,example2.com:27017\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("连接 replica set 三台服务器 (端口 27017, 27018, 和 27019):")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mongodb://localhost,localhost:27018,localhost:27019\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("连接 replica set 三台服务器, 写入操作应用在主服务器 并且分布查询到从服务器。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mongodb://host1,host2,host3/?slaveOk=true\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("直接连接第一个服务器，无论是 replica set 一部分或者主服务器或者从服务器。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mongodb://host1,host2,host3/?connect=direct;slaveOk=true\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("当你的连接服务器有优先级，还需要列出所有服务器，你可以使用上述连接方式。")]),s._v(" "),a("p",[s._v("安全模式连接到 localhost:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mongodb://localhost/?safe=true\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("以安全模式连接到 replica set，并且等待至少两个复制服务器成功写入，超时时间设置为 2 秒。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mongodb://host1,host2,host3/?safe=true;w=2;wtimeoutMS=2000\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"mongodb-后台管理-shell-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-后台管理-shell-2"}},[s._v("#")]),s._v(" MongoDB 后台管理 Shell")]),s._v(" "),a("p",[s._v("如果你需要进入 MongoDB 后台管理，你需要先打开 mongodb 装目录的下的 bin 目录，然后执行 mongo.exe 文件，MongoDB Shell 是 MongoDB 自带的交互式 Javascript shell,用来对 MongoDB 进行操作和管理的交互式环境。")]),s._v(" "),a("p",[s._v("当你进入 mongoDB 后台后，它默认会链接到 test 文档（数据库）：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("> mongo\nMongoDB shell version: 3.0.6\nconnecting to: test\n……\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("由于它是一个 JavaScript shell，您可以运行一些简单的算术运算:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("> 2 + 2\n4\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"创建数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建数据库"}},[s._v("#")]),s._v(" 创建数据库")]),s._v(" "),a("p",[s._v("use DATABASE_NAME")]),s._v(" "),a("p",[s._v("如果没有数据库则会创建数据库")]),s._v(" "),a("h3",{attrs:{id:"示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[s._v("#")]),s._v(" 示例")]),s._v(" "),a("p",[s._v("如果想创建一个数据库名称 "),a("code",[s._v("<mydb>")]),s._v(", 那么 use DATABASE 语句如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" > use mydb\nswitched to db mydb\n > db\nmydb\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"显示所有数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#显示所有数据库"}},[s._v("#")]),s._v(" 显示所有数据库")]),s._v(" "),a("p",[s._v("show dbs")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" > show dbs\nadmin   0.000GB\nconfig  0.000GB\nlocal   0.000GB\ntest    0.000GB\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("可以看到，我们刚创建的数据库 mydb 并不在数据库的列表中， 要显示它，我们需要向 mydb 数据库插入一些数据。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.mydb.insert({"name":"菜鸟教程"})\nWriteResult({ "nInserted" : 1 })\n> show dbs\nadmin   0.000GB\nconfig  0.000GB\nlocal   0.000GB\nmydb    0.000GB\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h2",{attrs:{id:"显示当前数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#显示当前数据库"}},[s._v("#")]),s._v(" 显示当前数据库")]),s._v(" "),a("p",[s._v("show db")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" > db\n mydb\n\n 或者\n > show db  //4.0版本以下\n mydb\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h2",{attrs:{id:"删除数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除数据库"}},[s._v("#")]),s._v(" 删除数据库")]),s._v(" "),a("p",[s._v("语法 MongoDB 删除数据库的语法格式如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("> db.dropDatabase()\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例"}},[s._v("#")]),s._v(" 实例")]),s._v(" "),a("p",[s._v("以下实例我们删除了数据库 tempdb。")]),s._v(" "),a("p",[s._v("首先，查看所有数据库：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("> show dbs\nadmin   0.000GB\nconfig  0.000GB\ntempdb  0.000GB\nlocal   0.000GB\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("接下来我们切换到数据库 tempdb：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("> use tempdb\nswitched to db tempdb\n>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("执行删除命令：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.dropDatabase()\n{ "dropped" : "tempdb", "ok" : 1 }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("最后，我们再通过 show dbs 命令数据库是否删除成功：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("> show dbs\nadmin   0.000GB\nconfig  0.000GB\nlocal   0.000GB\ntest    0.000GB\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"显示合集"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#显示合集"}},[s._v("#")]),s._v(" 显示合集")]),s._v(" "),a("p",[s._v("show collections")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" > show collections\n test1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"创建集合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建集合"}},[s._v("#")]),s._v(" 创建集合")]),s._v(" "),a("p",[s._v("如果该集合当前不存在，则插入操作将创建该集合。")]),s._v(" "),a("p",[s._v("或者 使用 "),a("code",[s._v("db.createCollection(name, options)")]),s._v("方法")]),s._v(" "),a("p",[s._v("参数说明：")]),s._v(" "),a("ul",[a("li",[s._v("name: 要创建的集合名称")]),s._v(" "),a("li",[s._v("options: 可选参数, 指定有关内存大小及索引的选项")])]),s._v(" "),a("p",[s._v("options 可以是如下参数：")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("字段")]),s._v(" "),a("th",[s._v("类型")]),s._v(" "),a("th",[s._v("描述")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("capped")]),s._v(" "),a("td",[s._v("布尔")]),s._v(" "),a("td",[s._v("（可选）如果为 true，则创建固定集合。固定集合是指有着固定大小的集合，当达到最大值时，它会自动覆盖最早的文档。当该值为 true 时，必须指定 size 参数。")])]),s._v(" "),a("tr",[a("td",[s._v("autoIndexId")]),s._v(" "),a("td",[s._v("布尔")]),s._v(" "),a("td",[s._v("3.2 之后不再支持该参数。（可选）如为 true，自动在 _id 字段创建索引。默认为 false。")])]),s._v(" "),a("tr",[a("td",[s._v("size")]),s._v(" "),a("td",[s._v("数值")]),s._v(" "),a("td",[s._v("（可选）为固定集合指定一个最大值，即字节数。如果 capped 为 true，也需要指定该字段。")])]),s._v(" "),a("tr",[a("td",[s._v("max")]),s._v(" "),a("td",[s._v("数值")]),s._v(" "),a("td",[s._v("（可选）指定固定集合中包含文档的最大数量。 在插入文档时，MongoDB 首先检查固定集合的 size 字段，然后检查 max 字段。")])])])]),s._v(" "),a("h2",{attrs:{id:"示例-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例-2"}},[s._v("#")]),s._v(" 示例")]),s._v(" "),a("p",[s._v("在 test 数据库中创建 site 集合：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> use test\nswitched to db test\n> db.createCollection("site")\n{ "ok" : 1 }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("如果要查看已有集合，可以使用 "),a("code",[s._v("show collections")]),s._v(" 或 "),a("code",[s._v("show tables")]),s._v(" 命令：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("> show collections\nsite\n> show tables\nsite\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("下面是带有几个关键参数的 "),a("code",[s._v("createCollection()")]),s._v(" 的用法：")]),s._v(" "),a("p",[s._v("创建固定集合 mycol，整个集合空间大小 6142800 B, 文档最大个数为 10000 个。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.createCollection("mycol", { capped : true, autoIndexId : true, size :\n   6142800, max : 10000 } )\n{ "ok" : 1 }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("在 MongoDB 中，你不需要创建集合。当你插入一些文档时，MongoDB 会自动创建集合。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.mycol2.insert({"name" : "Tony"})\nWriteResult({ "nInserted" : 1 })\n> show collections\nmycol2\nsite\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"选中集合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#选中集合"}},[s._v("#")]),s._v(" 选中集合")]),s._v(" "),a("p",[s._v("一般是使用 db.collection 代表选中了集合，但是，如果 mongoshell 不接受集合的名称，您可以使用替代"),a("code",[s._v("db.getCollection()")]),s._v("语法。例如，如果集合名称包含空格或连字符、以数字开头或与内置函数冲突：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('db.getCollection("3 test").find()\ndb.getCollection("3-test").find()\ndb.getCollection("stats").find()\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"删除集合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除集合"}},[s._v("#")]),s._v(" 删除集合")]),s._v(" "),a("p",[s._v("集合删除语法格式如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.collection.drop()\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("以下实例删除了 tempdb 数据库中的集合 site：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> use tempdb\nswitched to db tempdb\n> db.createCollection("site")     # 先创建集合，类似数据库中的表\n> show collections             # show collections 命令会更加准确点\nsite\n> db.site.drop()\ntrue\n> show collections\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h3",{attrs:{id:"id字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#id字段"}},[s._v("#")]),s._v(" "),a("code",[s._v("_id")]),s._v("字段")]),s._v(" "),a("p",[s._v("在 MongoDB 中，存储在集合中的每个文档都需要一个唯一的 "),a("a",{attrs:{href:"https://docs.mongodb.com/v4.4/reference/glossary/#std-term-_id",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("_id")]),a("OutboundLink")],1),s._v(" 字段作为"),a("a",{attrs:{href:"https://docs.mongodb.com/v4.4/reference/glossary/#std-term-primary-key",target:"_blank",rel:"noopener noreferrer"}},[s._v("主键"),a("OutboundLink")],1),s._v("。如果插入的文档省略了该"),a("code",[s._v("_id")]),s._v(" 字段，MongoDB 驱动程序会自动为该字段生成一个 "),a("a",{attrs:{href:"https://docs.mongodb.com/v4.4/reference/bson-types/#std-label-objectid",target:"_blank",rel:"noopener noreferrer"}},[s._v("ObjectId"),a("OutboundLink")],1),a("code",[s._v("_id")]),s._v("。")]),s._v(" "),a("p",[s._v("这也适用于通过 "),a("a",{attrs:{href:"https://docs.mongodb.com/v4.4/reference/method/db.collection.update/#std-label-upsert-parameter",target:"_blank",rel:"noopener noreferrer"}},[s._v("upsert: true"),a("OutboundLink")],1),s._v(" 更新操作插入的文档。")]),s._v(" "),a("h2",{attrs:{id:"插入方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#插入方法"}},[s._v("#")]),s._v(" 插入方法")]),s._v(" "),a("p",[s._v("MongoDB 提供了以下方法将文档插入到集合中：")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("方法")]),s._v(" "),a("th",[s._v("作用")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[a("code",[s._v("db.collection.insertOne()")])]),s._v(" "),a("td",[s._v("将单个文档插入到集合中。")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("db.collection.insertMany()")])]),s._v(" "),a("td",[s._v("将多个 文档插入到一个集合中。")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("db.collection.insert()")])]),s._v(" "),a("td",[s._v("将单个文档或多个文档插入到集合中。")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("db.collection.save()")])]),s._v(" "),a("td",[s._v("将单个文档或多个文档插入到集合中。如果 _id 主键存在则更新数据，如果不存在就插入数据。(从 MongoDB 4.2 开始弃用)")])])])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.collection.insertOne(\n   <document>,\n   {\n      writeConcern: <document>\n   }\n)\n\ndb.collection.insertMany(\n   [ <document 1> , <document 2>, ... ],\n   {\n      writeConcern: <document>,\n      ordered: <boolean>\n   }\n)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("参数说明：")]),s._v(" "),a("ul",[a("li",[s._v("document：要写入的文档。")]),s._v(" "),a("li",[s._v("writeConcern：写入策略，默认为 1，即要求确认写操作，0 是不要求。")]),s._v(" "),a("li",[s._v("ordered：指定是否按顺序写入，默认 true，按顺序写入。")])]),s._v(" "),a("h3",{attrs:{id:"示例-插入单个文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例-插入单个文档"}},[s._v("#")]),s._v(" 示例 插入单个文档")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.insertOne(\n   { item: "canvas", qty: 100, tags: ["cotton"], size: { h: 28, w: 35.5, uom: "cm" } }\n)\n{ "_id" : ObjectId("61272e30adc0bcb6d3c1d9b3"), "item" : "canvas", "qty" : 100, "tags" : [ "cotton" ], "size" : { "h" : 28, "w" : 35.5, "uom" : "cm" } }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("要检索您刚刚插入的文档，请"),a("a",{attrs:{href:"https://docs.mongodb.com/v4.4/core/document/#std-label-document-query-filter",target:"_blank",rel:"noopener noreferrer"}},[s._v("查询集合"),a("OutboundLink")],1),s._v("：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { item: "canvas" } )\n{ "_id" : ObjectId("61272e30adc0bcb6d3c1d9b3"), "item" : "canvas", "qty" : 100, "tags" : [ "cotton" ], "size" : { "h" : 28, "w" : 35.5, "uom" : "cm" } }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"示例-插入多个文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例-插入多个文档"}},[s._v("#")]),s._v(" 示例 插入多个文档")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.insertMany([\n   { item: "journal", qty: 25, tags: ["blank", "red"], size: { h: 14, w: 21, uom: "cm" } },\n   { item: "mat", qty: 85, tags: ["gray"], size: { h: 27.9, w: 35.5, uom: "cm" } },\n   { item: "mousepad", qty: 25, tags: ["gel", "blue"], size: { h: 19, w: 22.85, uom: "cm" } }\n])\n{\n        "acknowledged" : true,\n        "insertedIds" : [\n                ObjectId("61272f16adc0bcb6d3c1d9b4"),\n                ObjectId("61272f16adc0bcb6d3c1d9b5"),\n                ObjectId("61272f16adc0bcb6d3c1d9b6")\n        ]\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("要检索您刚刚插入的文档，请"),a("a",{attrs:{href:"https://docs.mongodb.com/v4.4/core/document/#std-label-document-query-filter",target:"_blank",rel:"noopener noreferrer"}},[s._v("查询集合"),a("OutboundLink")],1),s._v("：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( {} )\n{ "_id" : ObjectId("61272e30adc0bcb6d3c1d9b3"), "item" : "canvas", "qty" : 100, "tags" : [ "cotton" ], "size" : { "h" : 28, "w" : 35.5, "uom" : "cm" } }\n{ "_id" : ObjectId("61272f16adc0bcb6d3c1d9b4"), "item" : "journal", "qty" : 25, "tags" : [ "blank", "red" ], "size" : { "h" : 14, "w" : 21, "uom" : "cm" } }\n{ "_id" : ObjectId("61272f16adc0bcb6d3c1d9b5"), "item" : "mat", "qty" : 85, "tags" : [ "gray" ], "size" : { "h" : 27.9, "w" : 35.5, "uom" : "cm" } }\n{ "_id" : ObjectId("61272f16adc0bcb6d3c1d9b6"), "item" : "mousepad", "qty" : 25, "tags" : [ "gel", "blue" ], "size" : { "h" : 19, "w" : 22.85, "uom" : "cm" } }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"使用-insert"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-insert"}},[s._v("#")]),s._v(" 使用 insert")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.insert([\n... ...   { item: "journal2", qty: 26, tags: ["pink", "red"], size: { h: 20, w: 21, uom: "cm" } },\n... ...   { item: "mat2", qty: 84, tags: ["gray"], size: { h: 27, w: 32, uom: "cm" } },\n... ... ])\nBulkWriteResult({\n        "writeErrors" : [ ],\n        "writeConcernErrors" : [ ],\n        "nInserted" : 2,\n        "nUpserted" : 0,\n        "nMatched" : 0,\n        "nModified" : 0,\n        "nRemoved" : 0,\n        "upserted" : [ ]\n})\n> db.inventory.find( {} )\n{ "_id" : ObjectId("61272e30adc0bcb6d3c1d9b3"), "item" : "canvas", "qty" : 100, "tags" : [ "cotton" ], "size" : { "h" : 28, "w" : 35.5, "uom" : "cm" } }\n{ "_id" : ObjectId("61272f16adc0bcb6d3c1d9b4"), "item" : "journal", "qty" : 25, "tags" : [ "blank", "red" ], "size" : { "h" : 14, "w" : 21, "uom" : "cm" } }\n{ "_id" : ObjectId("61272f16adc0bcb6d3c1d9b5"), "item" : "mat", "qty" : 85, "tags" : [ "gray" ], "size" : { "h" : 27.9, "w" : 35.5, "uom" : "cm" } }\n{ "_id" : ObjectId("61272f16adc0bcb6d3c1d9b6"), "item" : "mousepad", "qty" : 25, "tags" : [ "gel", "blue" ], "size" : { "h" : 19, "w" : 22.85, "uom" : "cm" } }\n{ "_id" : ObjectId("612732ecadc0bcb6d3c1d9b7"), "item" : "journal1", "qty" : 26, "tags" : [ "pink", "red" ], "size" : { "h" : 20, "w" : 21, "uom" : "cm" } }\n{ "_id" : ObjectId("612732ecadc0bcb6d3c1d9b8"), "item" : "mat1", "qty" : 84, "tags" : [ "gray" ], "size" : { "h" : 27, "w" : 32, "uom" : "cm" } }\n{ "_id" : ObjectId("61273322adc0bcb6d3c1d9b9"), "item" : "journal2", "qty" : 26, "tags" : [ "pink", "red" ], "size" : { "h" : 20, "w" : 21, "uom" : "cm" } }\n{ "_id" : ObjectId("61273322adc0bcb6d3c1d9ba"), "item" : "mat2", "qty" : 84, "tags" : [ "gray" ], "size" : { "h" : 27, "w" : 32, "uom" : "cm" } }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h2",{attrs:{id:"插入数据变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#插入数据变量"}},[s._v("#")]),s._v(" 插入数据变量")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("> document=({title: 'MongoDB 教程'});\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("执行后显示结果如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> document=({title: \'MongoDB 教程\'});\n{ "title" : "MongoDB 教程" }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("执行插入操作：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.insert(document)\nWriteResult({ "nInserted" : 1 })\n> db.col.find()\n{ "_id" : ObjectId("612756f8adc0bcb6d3c1d9c8"), "title" : "MongoDB 教程" }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"原子性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原子性"}},[s._v("#")]),s._v(" 原子性")]),s._v(" "),a("p",[s._v("MongoDB 中的所有写操作在单个文档的级别上都是原子的。有关 MongoDB 和原子性的更多信息，请参阅 "),a("a",{attrs:{href:"https://docs.mongodb.com/v4.4/core/write-operations-atomicity/",target:"_blank",rel:"noopener noreferrer"}},[s._v("原子性和事务"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"查询文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询文档"}},[s._v("#")]),s._v(" 查询文档")]),s._v(" "),a("p",[s._v("语法")]),s._v(" "),a("p",[s._v("MongoDB 查询数据的语法格式如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(">db.COLLECTION_NAME.find(query, projection)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("query ：可选，使用查询操作符指定查询条件")]),s._v(" "),a("li",[s._v("projection ：可选，使用投影操作符指定返回的键。查询时返回文档中所有键值， 只需省略该参数即可（默认省略）。")])]),s._v(" "),a("p",[s._v("find() 方法以非结构化的方式来显示所有文档。")]),s._v(" "),a("p",[s._v("如果你需要以易读的方式来读取数据，可以使用 pretty() 方法，语法格式如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(">db.myCollection.find().pretty()\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("pretty() 方法以格式化的方式来显示所有文档。")]),s._v(" "),a("p",[s._v("除了 "),a("code",[s._v("find()")]),s._v(" 方法之外，还有一个 "),a("code",[s._v("findOne()")]),s._v(" 方法，它只返回一个文档。")]),s._v(" "),a("h2",{attrs:{id:"mongodb-与-rdbms-where-语句比较"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-与-rdbms-where-语句比较"}},[s._v("#")]),s._v(" MongoDB 与 RDBMS Where 语句比较")]),s._v(" "),a("p",[s._v("如果你熟悉常规的 SQL 数据，通过下表可以更好的理解 MongoDB 的条件语句查询：")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("操作")]),s._v(" "),a("th",[s._v("格式")]),s._v(" "),a("th",[s._v("范例")]),s._v(" "),a("th",[s._v("RDBMS 中的类似语句")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("等于")]),s._v(" "),a("td",[s._v("{"),a("code",[s._v("<key>")]),s._v(":"),a("code",[s._v("<value>")]),s._v("}")]),s._v(" "),a("td",[s._v('db.col.find({"by":"菜鸟教程"}).pretty() where by = \'菜鸟教程\'')]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("小于")]),s._v(" "),a("td",[s._v("{"),a("code",[s._v("<key>")]),s._v(":{$lt:"),a("code",[s._v("<value>")]),s._v("}}")]),s._v(" "),a("td",[s._v('db.col.find({"likes":{$lt:50}}).pretty()')]),s._v(" "),a("td",[s._v("where likes < 50")])]),s._v(" "),a("tr",[a("td",[s._v("小于或等于")]),s._v(" "),a("td",[s._v("{"),a("code",[s._v("<key>")]),s._v(":{$lte:"),a("code",[s._v("<value>")]),s._v("}}")]),s._v(" "),a("td",[s._v('db.col.find({"likes":{$lte:50}}).pretty()')]),s._v(" "),a("td",[s._v("where likes <= 50")])]),s._v(" "),a("tr",[a("td",[s._v("大于")]),s._v(" "),a("td",[s._v("{"),a("code",[s._v("<key>")]),s._v(":{$gt:"),a("code",[s._v("<value>")]),s._v("}}")]),s._v(" "),a("td",[s._v('db.col.find({"likes":{$gt:50}}).pretty()')]),s._v(" "),a("td",[s._v("where likes > 50")])]),s._v(" "),a("tr",[a("td",[s._v("大于或等于")]),s._v(" "),a("td",[s._v("{"),a("code",[s._v("<key>")]),s._v(":{$gte:"),a("code",[s._v("<value>")]),s._v("}}")]),s._v(" "),a("td",[s._v('db.col.find({"likes":{$gte:50}}).pretty()')]),s._v(" "),a("td",[s._v("where likes >= 50")])]),s._v(" "),a("tr",[a("td",[s._v("不等于")]),s._v(" "),a("td",[s._v("{"),a("code",[s._v("<key>")]),s._v(":{$ne:"),a("code",[s._v("<value>")]),s._v("}}")]),s._v(" "),a("td",[s._v('db.col.find({"likes":{$ne:50}}).pretty()')]),s._v(" "),a("td",[s._v("where likes != 50")])])])]),s._v(" "),a("h3",{attrs:{id:"mongodb-and-条件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-and-条件"}},[s._v("#")]),s._v(" MongoDB AND 条件")]),s._v(" "),a("p",[s._v("MongoDB 的 find() 方法可以传入多个键(key)，每个键(key)以逗号隔开，即常规 SQL 的 AND 条件。")]),s._v(" "),a("p",[s._v("语法格式如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(">db.col.find({key1:value1, key2:value2}).pretty()\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"实例-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例-2"}},[s._v("#")]),s._v(" 实例")]),s._v(" "),a("p",[s._v("以下实例通过 by 和 title 键来查询 zzl 中 MongoDB 教程 的数据")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find({"by":"zzl", "title":"MongoDB 教程"}).pretty()\n{\n        "_id" : ObjectId("612f493a220ce5ce5c2b4cce"),\n        "title" : "MongoDB 教程",\n        "description" : "MongoDB 是一个 Nosql 数据库",\n        "by" : "zzl",\n        "url" : "http://10.8.103.47:9000",\n        "tags" : [\n                "mongodb",\n                "database",\n                "NoSQL"\n        ],\n        "likes" : 100\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("以上实例中类似于 WHERE 语句："),a("code",[s._v("WHERE by='菜鸟教程' AND title='MongoDB 教程'")])]),s._v(" "),a("h2",{attrs:{id:"mongodb-or-条件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-or-条件"}},[s._v("#")]),s._v(" MongoDB OR 条件")]),s._v(" "),a("p",[s._v("MongoDB OR 条件语句使用了关键字 "),a("code",[s._v("$or")]),s._v(",语法格式如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(">db.col.find(\n   {\n      $or: [\n         {key1: value1}, {key2:value2}\n      ]\n   }\n).pretty()\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h2",{attrs:{id:"实例-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例-3"}},[s._v("#")]),s._v(" 实例")]),s._v(" "),a("p",[s._v("以下实例中，我们演示了查询键 by 值为 zzl 或键 title 值为 MongoDB 教程 的文档。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find({$or:[{"by":"zzl"},{"title": "MongoDB 教程"}]}).pretty()\n{\n        "_id" : ObjectId("612f493a220ce5ce5c2b4cce"),\n        "title" : "MongoDB 教程",\n        "description" : "MongoDB 是一个 Nosql 数据库",\n        "by" : "zzl",\n        "url" : "http://10.8.103.47:9000",\n        "tags" : [\n                "mongodb",\n                "database",\n                "NoSQL"\n        ],\n        "likes" : 100\n}\n{\n        "_id" : ObjectId("612f493d220ce5ce5c2b4ccf"),\n        "title" : "MongoDB",\n        "description" : "MongoDB 是一个 Nosql 数据库",\n        "by" : "zzl",\n        "url" : "http://10.8.103.47:9000",\n        "tags" : [\n                "mongodb",\n                "database",\n                "NoSQL"\n        ],\n        "likes" : 100\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("h2",{attrs:{id:"and-和-or-联合使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#and-和-or-联合使用"}},[s._v("#")]),s._v(" AND 和 OR 联合使用")]),s._v(" "),a("p",[s._v("以下实例演示了 AND 和 OR 联合使用，类似常规 SQL 语句为： "),a("code",[s._v("'where likes>50 AND (by = 'zzl' OR title = 'MongoDB 教程')'")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find({"likes": {$gt:50}, $or: [{"by": "zzl"},{"title": "MongoDB 教程"}]}).pretty()\n{\n        "_id" : ObjectId("612f493a220ce5ce5c2b4cce"),\n        "title" : "MongoDB 教程",\n        "description" : "MongoDB 是一个 Nosql 数据库",\n        "by" : "zzl",\n        "url" : "http://10.8.103.47:9000",\n        "tags" : [\n                "mongodb",\n                "database",\n                "NoSQL"\n        ],\n        "likes" : 100\n}\n{\n        "_id" : ObjectId("612f493d220ce5ce5c2b4ccf"),\n        "title" : "MongoDB",\n        "description" : "MongoDB 是一个 Nosql 数据库",\n        "by" : "zzl",\n        "url" : "http://10.8.103.47:9000",\n        "tags" : [\n                "mongodb",\n                "database",\n                "NoSQL"\n        ],\n        "likes" : 100\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("h2",{attrs:{id:"查询嵌套-嵌入文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询嵌套-嵌入文档"}},[s._v("#")]),s._v(" 查询嵌套/嵌入文档")]),s._v(" "),a("p",[s._v("示例:\n有以下数据：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find().pretty()\n{\n        "_id" : ObjectId("613066ed61e58538d1d25a86"),\n        "item" : "notebook",\n        "qty" : 50,\n        "size" : {\n                "h" : 8.5,\n                "w" : 11,\n                "umo" : "in"\n        },\n        "status" : "A"\n}\n{\n        "_id" : ObjectId("613066ff61e58538d1d25a87"),\n        "item" : "paper",\n        "qty" : 100,\n        "size" : {\n                "h" : 8.5,\n                "w" : 11,\n                "umo" : "cm"\n        },\n        "status" : "D"\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h2",{attrs:{id:"匹配嵌入-嵌套文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#匹配嵌入-嵌套文档"}},[s._v("#")]),s._v(" 匹配嵌入/嵌套文档")]),s._v(" "),a("p",[s._v('选择字段中 uom 嵌套的 size 字段等于 的所有文档"in"：\n整个嵌入文档的相等匹配需要 指定文档的精确匹配'),a("code",[s._v("<value>")]),s._v("，包括字段顺序")]),s._v(" "),a("p",[s._v('例如，以下查询{w:8.5,h:11,umo:"in" }不匹配 inventory 集合中的任何文档 ：``：')]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find({size:{w:8.5,h:11,umo:"in"}})\n           // 查询为空 因为顺序不对\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("以下查询选择字段 size 等于 document 的所有 文档"),a("code",[s._v('{h:8.5,w:11,umo:"in"}')]),s._v("：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find({size:{h:8.5,w:11,umo:"in"}}).pretty()\n{\n        "_id" : ObjectId("613066ed61e58538d1d25a86"),\n        "item" : "notebook",\n        "qty" : 50,\n        "size" : {\n                "h" : 8.5,\n                "w" : 11,\n                "umo" : "in"\n        },\n        "status" : "A"\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h2",{attrs:{id:"在嵌套字段上指定相等匹配"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在嵌套字段上指定相等匹配"}},[s._v("#")]),s._v(" 在嵌套字段上指定相等匹配：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find( { "size.umo": "in"} ).pretty()\n{\n        "_id" : ObjectId("613066ed61e58538d1d25a86"),\n        "item" : "notebook",\n        "qty" : 50,\n        "size" : {\n                "h" : 8.5,\n                "w" : 11,\n                "umo" : "in"\n        },\n        "status" : "A"\n}\n>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h2",{attrs:{id:"查询一个元素的数组"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询一个元素的数组"}},[s._v("#")]),s._v(" 查询一个元素的数组")]),s._v(" "),a("p",[s._v("插入数据")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('db.inventory.insertMany([\n   { item: "journal", qty: 25, tags: ["blank", "red"], dim_cm: [ 14, 21 ] },\n   { item: "notebook", qty: 50, tags: ["red", "blank"], dim_cm: [ 14, 21 ] },\n   { item: "paper", qty: 100, tags: ["red", "blank", "plain"], dim_cm: [ 14, 21 ] },\n   { item: "planner", qty: 75, tags: ["blank", "red"], dim_cm: [ 22.85, 30 ] },\n   { item: "postcard", qty: 45, tags: ["blue"], dim_cm: [ 10, 15.25 ] }\n]);\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h2",{attrs:{id:"匹配一个数组"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#匹配一个数组"}},[s._v("#")]),s._v(" 匹配一个数组")]),s._v(" "),a("p",[s._v("要在数组上指定相等条件，请使用查询文档{"),a("code",[s._v("<field>")]),s._v("："),a("code",[s._v("<value>")]),s._v("}，其中"),a("code",[s._v("<value>")]),s._v("是要匹配的精确数组，包括元素的顺序。")]),s._v(" "),a("p",[s._v('以下示例查询所有文档，其中字段 tags 值是正好包含两个元素的数组，"red"并且"blank", 按指定的顺序：')]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { tags: ["red", "blank"] } ).pretty()\n{\n        "_id" : ObjectId("61306adb61e58538d1d25a89"),\n        "item" : "notebook",\n        "qty" : 50,\n        "tags" : [\n                "red",\n                "blank"\n        ],\n        "dim_cm" : [\n                14,\n                21\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("相反，如果希望查找同时包含元素“red”和“blank”的数组，而不考虑数组中的顺序或其他元素，请使用$all 运算符：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { tags: { $all: ["red", "blank"] } } ).pretty()\n{\n        "_id" : ObjectId("61306adb61e58538d1d25a88"),\n        "item" : "journal",\n        "qty" : 25,\n        "tags" : [\n                "blank",\n                "red"\n        ],\n        "dim_cm" : [\n                14,\n                21\n        ]\n}\n{\n        "_id" : ObjectId("61306adb61e58538d1d25a89"),\n        "item" : "notebook",\n        "qty" : 50,\n        "tags" : [\n                "red",\n                "blank"\n        ],\n        "dim_cm" : [\n                14,\n                21\n        ]\n}\n{\n        "_id" : ObjectId("61306adb61e58538d1d25a8a"),\n        "item" : "paper",\n        "qty" : 100,\n        "tags" : [\n                "red",\n                "blank",\n                "plain"\n        ],\n        "dim_cm" : [\n                14,\n                21\n        ]\n}\n{\n        "_id" : ObjectId("61306adb61e58538d1d25a8b"),\n        "item" : "planner",\n        "qty" : 75,\n        "tags" : [\n                "blank",\n                "red"\n        ],\n        "dim_cm" : [\n                22.85,\n                30\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br")])]),a("h2",{attrs:{id:"查询数组中的元素"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询数组中的元素"}},[s._v("#")]),s._v(" 查询数组中的元素")]),s._v(" "),a("p",[s._v("要查询数组字段是否包含至少一个具有指定值的元素，请使用过滤器{"),a("code",[s._v("<field>")]),s._v("："),a("code",[s._v("<value>")]),s._v("}，其中"),a("code",[s._v("<value>")]),s._v("是元素值。")]),s._v(" "),a("p",[s._v('以下示例查询所有文档，其中 tags 是一个包含字符串"red"作为其元素之一的数组：')]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { tags: "red" } ).pretty()\n{\n        "_id" : ObjectId("61306adb61e58538d1d25a88"),\n        "item" : "journal",\n        "qty" : 25,\n        "tags" : [\n                "blank",\n                "red"\n        ],\n        "dim_cm" : [\n                14,\n                21\n        ]\n}\n{\n        "_id" : ObjectId("61306adb61e58538d1d25a89"),\n        "item" : "notebook",\n        "qty" : 50,\n        "tags" : [\n                "red",\n                "blank"\n        ],\n        "dim_cm" : [\n                14,\n                21\n        ]\n}\n{\n        "_id" : ObjectId("61306adb61e58538d1d25a8a"),\n        "item" : "paper",\n        "qty" : 100,\n        "tags" : [\n                "red",\n                "blank",\n                "plain"\n        ],\n        "dim_cm" : [\n                14,\n                21\n        ]\n}\n{\n        "_id" : ObjectId("61306adb61e58538d1d25a8b"),\n        "item" : "planner",\n        "qty" : 75,\n        "tags" : [\n                "blank",\n                "red"\n        ],\n        "dim_cm" : [\n                22.85,\n                30\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br")])]),a("p",[s._v("要对数组字段中的元素指定条件，请在 查询过滤器文档中使用查询运算符：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("{ <array field>: { <operator1>: <value1>, ... } }\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("例如，以下操作查询数组 dim_cm 中至少包含一个值大于 的 所有文档 25。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { dim_cm: { $gt: 25 } } ).pretty()\n{\n        "_id" : ObjectId("61306adb61e58538d1d25a8b"),\n        "item" : "planner",\n        "qty" : 75,\n        "tags" : [\n                "blank",\n                "red"\n        ],\n        "dim_cm" : [\n                22.85,\n                30\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h2",{attrs:{id:"为数组元素指定多个条件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为数组元素指定多个条件"}},[s._v("#")]),s._v(" 为数组元素指定多个条件")]),s._v(" "),a("p",[s._v("在数组元素上指定复合条件时，可以指定查询，以便单个数组元素满足这些条件，或者数组元素的任意组合满足这些条件。")]),s._v(" "),a("h2",{attrs:{id:"在数组元素上查询具有复合筛选条件的数组"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在数组元素上查询具有复合筛选条件的数组"}},[s._v("#")]),s._v(" 在数组元素上查询具有复合筛选条件的数组")]),s._v(" "),a("p",[s._v("下面的示例查询文档，其中 dim_cm 数组包含在某种组合中满足查询条件的元素；e、 例如，一个元素可以满足大于 15 的条件，另一个元素可以满足小于 20 的条件，或者一个元素可以同时满足这两个条件：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { dim_cm: { $gt: 15, $lt: 20 } } ).pretty()\n{\n        "_id" : ObjectId("61306adb61e58538d1d25a88"),\n        "item" : "journal",\n        "qty" : 25,\n        "tags" : [\n                "blank",\n                "red"\n        ],\n        "dim_cm" : [\n                14,\n                21\n        ]\n}\n{\n        "_id" : ObjectId("61306adb61e58538d1d25a89"),\n        "item" : "notebook",\n        "qty" : 50,\n        "tags" : [\n                "red",\n                "blank"\n        ],\n        "dim_cm" : [\n                14,\n                21\n        ]\n}\n{\n        "_id" : ObjectId("61306adb61e58538d1d25a8a"),\n        "item" : "paper",\n        "qty" : 100,\n        "tags" : [\n                "red",\n                "blank",\n                "plain"\n        ],\n        "dim_cm" : [\n                14,\n                21\n        ]\n}\n{\n        "_id" : ObjectId("61306adb61e58538d1d25a8c"),\n        "item" : "postcard",\n        "qty" : 45,\n        "tags" : [\n                "blue"\n        ],\n        "dim_cm" : [\n                10,\n                15.25\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br")])]),a("h2",{attrs:{id:"按数组索引位置查询元素"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#按数组索引位置查询元素"}},[s._v("#")]),s._v(" 按数组索引位置查询元素")]),s._v(" "),a("p",[s._v("使用点表示法，可以在数组的特定索引或位置为元素指定查询条件。该数组使用基于零的索引。")]),s._v(" "),a("blockquote",[a("p",[s._v("使用点表示法查询时，字段和嵌套字段必须位于引号内。")])]),s._v(" "),a("p",[s._v("以下示例查询数组 dim_cm 中第二个元素大于 25 的所有文档：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { "dim_cm.1": { $gt: 25 } } ).pretty()\n{\n        "_id" : ObjectId("61306adb61e58538d1d25a8b"),\n        "item" : "planner",\n        "qty" : 75,\n        "tags" : [\n                "blank",\n                "red"\n        ],\n        "dim_cm" : [\n                22.85,\n                30\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h2",{attrs:{id:"按数组长度查询数组"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#按数组长度查询数组"}},[s._v("#")]),s._v(" 按数组长度查询数组")]),s._v(" "),a("p",[s._v("使用"),a("code",[s._v("$size")]),s._v("运算符按元素数查询数组。例如，下面选择数组标记有 3 个元素的文档。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { "tags": { $size: 3 } } ).pretty()\n{\n        "_id" : ObjectId("61306adb61e58538d1d25a8a"),\n        "item" : "paper",\n        "qty" : 100,\n        "tags" : [\n                "red",\n                "blank",\n                "plain"\n        ],\n        "dim_cm" : [\n                14,\n                21\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("h2",{attrs:{id:"查询嵌入文档的数组"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询嵌入文档的数组"}},[s._v("#")]),s._v(" 查询嵌入文档的数组")]),s._v(" "),a("p",[s._v("插入数据")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('db.inventory.insertMany( [\n   { item: "journal", instock: [ { warehouse: "A", qty: 5 }, { warehouse: "C", qty: 15 } ] },\n   { item: "notebook", instock: [ { warehouse: "C", qty: 5 } ] },\n   { item: "paper", instock: [ { warehouse: "A", qty: 60 }, { warehouse: "B", qty: 15 } ] },\n   { item: "planner", instock: [ { warehouse: "A", qty: 40 }, { warehouse: "B", qty: 5 } ] },\n   { item: "postcard", instock: [ { warehouse: "B", qty: 15 }, { warehouse: "C", qty: 35 } ] }\n]);\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("整个嵌入/嵌套文档的相等匹配要求与指定文档（包括字段顺序）完全匹配。例如，以下查询与库存集合中的任何文档都不匹配：")]),s._v(" "),a("h2",{attrs:{id:"查询嵌套在数组中的文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询嵌套在数组中的文档"}},[s._v("#")]),s._v(" 查询嵌套在数组中的文档")]),s._v(" "),a("p",[s._v("以下示例选择 instock 数组中的元素与指定文档匹配的所有文档：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { "instock": { warehouse: "A", qty: 5 } } ).pretty()\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a8d"),\n        "item" : "journal",\n        "instock" : [\n                {\n                        "warehouse" : "A",\n                        "qty" : 5\n                },\n                {\n                        "warehouse" : "C",\n                        "qty" : 15\n                }\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("整个嵌入/嵌套文档的相等匹配要求与指定文档（包括字段顺序）完全匹配。例如，以下查询与库存集合中的任何文档都不匹配：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { "instock": { qty: 5, warehouse: "A" } } )\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"在文档数组中的字段上指定查询条件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在文档数组中的字段上指定查询条件"}},[s._v("#")]),s._v(" 在文档数组中的字段上指定查询条件")]),s._v(" "),a("p",[s._v("如果不知道嵌套在数组中的文档的索引位置，请将数组字段的名称与点（.）和嵌套文档中的字段名称连接起来。")]),s._v(" "),a("p",[s._v("以下示例选择 instock 数组中至少有一个嵌入文档的所有文档，其中包含值小于或等于 20 的字段 qty：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { \'instock.qty\': { $lte: 20 } } ).pretty()\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a8d"),\n        "item" : "journal",\n        "instock" : [\n                {\n                        "warehouse" : "A",\n                        "qty" : 5\n                },\n                {\n                        "warehouse" : "C",\n                        "qty" : 15\n                }\n        ]\n}\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a8e"),\n        "item" : "notebook",\n        "instock" : [\n                {\n                        "warehouse" : "C",\n                        "qty" : 5\n                }\n        ]\n}\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a8f"),\n        "item" : "paper",\n        "instock" : [\n                {\n                        "warehouse" : "A",\n                        "qty" : 60\n                },\n                {\n                        "warehouse" : "B",\n                        "qty" : 15\n                }\n        ]\n}\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a90"),\n        "item" : "planner",\n        "instock" : [\n                {\n                        "warehouse" : "A",\n                        "qty" : 40\n                },\n                {\n                        "warehouse" : "B",\n                        "qty" : 5\n                }\n        ]\n}\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a91"),\n        "item" : "postcard",\n        "instock" : [\n                {\n                        "warehouse" : "B",\n                        "qty" : 15\n                },\n                {\n                        "warehouse" : "C",\n                        "qty" : 35\n                }\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br")])]),a("h2",{attrs:{id:"使用数组索引查询嵌入文档中的字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用数组索引查询嵌入文档中的字段"}},[s._v("#")]),s._v(" 使用数组索引查询嵌入文档中的字段")]),s._v(" "),a("p",[s._v("使用点表示法，可以为文档中特定索引或数组位置的字段指定查询条件。该数组使用基于零的索引。")]),s._v(" "),a("blockquote",[a("p",[s._v("使用点表示法进行查询时，字段和索引必须位于引号内。")])]),s._v(" "),a("p",[s._v("以下示例选择 instock 数组的第一个元素为包含字段 qty（其值小于或等于 20）的文档的所有文档：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { \'instock.0.qty\': { $lte: 20 } } ).pretty()\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a8d"),\n        "item" : "journal",\n        "instock" : [\n                {\n                        "warehouse" : "A",\n                        "qty" : 5\n                },\n                {\n                        "warehouse" : "C",\n                        "qty" : 15\n                }\n        ]\n}\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a8e"),\n        "item" : "notebook",\n        "instock" : [\n                {\n                        "warehouse" : "C",\n                        "qty" : 5\n                }\n        ]\n}\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a91"),\n        "item" : "postcard",\n        "instock" : [\n                {\n                        "warehouse" : "B",\n                        "qty" : 15\n                },\n                {\n                        "warehouse" : "C",\n                        "qty" : 35\n                }\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br")])]),a("h2",{attrs:{id:"为文档数组指定多个条件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为文档数组指定多个条件"}},[s._v("#")]),s._v(" 为文档数组指定多个条件")]),s._v(" "),a("p",[s._v("在对嵌套在文档数组中的多个字段指定条件时，可以指定查询，以便单个文档满足这些条件，或者数组中的任何文档组合（包括单个文档）满足这些条件。")]),s._v(" "),a("h2",{attrs:{id:"单个嵌套文档满足嵌套字段的多个查询条件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#单个嵌套文档满足嵌套字段的多个查询条件"}},[s._v("#")]),s._v(" 单个嵌套文档满足嵌套字段的多个查询条件")]),s._v(" "),a("p",[s._v("使用"),a("code",[s._v("$elemMatch")]),s._v("运算符在嵌入文档数组上指定多个条件，以便至少一个嵌入文档满足所有指定条件。")]),s._v(" "),a("p",[s._v("以下示例查询 instock 数组中至少有一个包含字段数量等于 5 和字段仓库数量等于 A 的嵌入文档的文档：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { "instock": { $elemMatch: { qty: 5, warehouse: "A" } } } ).pretty()\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a8d"),\n        "item" : "journal",\n        "instock" : [\n                {\n                        "warehouse" : "A",\n                        "qty" : 5\n                },\n                {\n                        "warehouse" : "C",\n                        "qty" : 15\n                }\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("以下示例查询 instock 数组中至少有一个嵌入文档包含大于 10 且小于或等于 20 的字段数量的文档：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { "instock": { $elemMatch: { qty: { $gt: 10, $lte: 20 } } } } ).pretty()\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a8d"),\n        "item" : "journal",\n        "instock" : [\n                {\n                        "warehouse" : "A",\n                        "qty" : 5\n                },\n                {\n                        "warehouse" : "C",\n                        "qty" : 15\n                }\n        ]\n}\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a8f"),\n        "item" : "paper",\n        "instock" : [\n                {\n                        "warehouse" : "A",\n                        "qty" : 60\n                },\n                {\n                        "warehouse" : "B",\n                        "qty" : 15\n                }\n        ]\n}\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a91"),\n        "item" : "postcard",\n        "instock" : [\n                {\n                        "warehouse" : "B",\n                        "qty" : 15\n                },\n                {\n                        "warehouse" : "C",\n                        "qty" : 35\n                }\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br")])]),a("h2",{attrs:{id:"元素的组合满足标准"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#元素的组合满足标准"}},[s._v("#")]),s._v(" 元素的组合满足标准")]),s._v(" "),a("p",[s._v("如果数组字段上的复合查询条件不使用"),a("code",[s._v("$elemMatch")]),s._v(" 运算符，则查询将选择其数组包含满足条件的任何元素组合的文档。")]),s._v(" "),a("p",[s._v("例如，以下查询匹配 instock 数组中嵌套的任何文档的数量字段大于 10 且数组中的任何文档（但不一定是同一嵌入文档）的数量字段小于或等于 20 的文档：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { "instock.qty": { $gt: 10,  $lte: 20 } } ).pretty()\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a8d"),\n        "item" : "journal",\n        "instock" : [\n                {\n                        "warehouse" : "A",\n                        "qty" : 5\n                },\n                {\n                        "warehouse" : "C",\n                        "qty" : 15\n                }\n        ]\n}\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a8f"),\n        "item" : "paper",\n        "instock" : [\n                {\n                        "warehouse" : "A",\n                        "qty" : 60\n                },\n                {\n                        "warehouse" : "B",\n                        "qty" : 15\n                }\n        ]\n}\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a90"),\n        "item" : "planner",\n        "instock" : [\n                {\n                        "warehouse" : "A",\n                        "qty" : 40\n                },\n                {\n                        "warehouse" : "B",\n                        "qty" : 5\n                }\n        ]\n}\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a91"),\n        "item" : "postcard",\n        "instock" : [\n                {\n                        "warehouse" : "B",\n                        "qty" : 15\n                },\n                {\n                        "warehouse" : "C",\n                        "qty" : 35\n                }\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br")])]),a("p",[s._v("以下示例查询 instock 数组中 qty 数量等于 5 并且字段 warehouse 为 A 的嵌入文档（但不一定是同一个嵌入文档）的文档")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { "instock.qty": 5, "instock.warehouse": "A" } ).pretty()\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a8d"),\n        "item" : "journal",\n        "instock" : [\n                {\n                        "warehouse" : "A",\n                        "qty" : 5\n                },\n                {\n                        "warehouse" : "C",\n                        "qty" : 15\n                }\n        ]\n}\n{\n        "_id" : ObjectId("61306dee61e58538d1d25a90"),\n        "item" : "planner",\n        "instock" : [\n                {\n                        "warehouse" : "A",\n                        "qty" : 40\n                },\n                {\n                        "warehouse" : "B",\n                        "qty" : 5\n                }\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br")])]),a("h2",{attrs:{id:"从查询返回的项目字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#从查询返回的项目字段"}},[s._v("#")]),s._v(" 从查询返回的项目字段")]),s._v(" "),a("p",[s._v("默认情况下，MongoDB 中的查询返回匹配文档中的所有字段。要限制 MongoDB 发送到应用程序的数据量，您可以包含一个投影文档来指定或限制要返回的字段。")]),s._v(" "),a("p",[s._v("插入数据：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('db.inventory.insertMany( [\n  { item: "journal", status: "A", size: { h: 14, w: 21, uom: "cm" }, instock: [ { warehouse: "A", qty: 5 } ] },\n  { item: "notebook", status: "A",  size: { h: 8.5, w: 11, uom: "in" }, instock: [ { warehouse: "C", qty: 5 } ] },\n  { item: "paper", status: "D", size: { h: 8.5, w: 11, uom: "in" }, instock: [ { warehouse: "A", qty: 60 } ] },\n  { item: "planner", status: "D", size: { h: 22.85, w: 30, uom: "cm" }, instock: [ { warehouse: "A", qty: 40 } ] },\n  { item: "postcard", status: "A", size: { h: 10, w: 15.25, uom: "cm" }, instock: [ { warehouse: "B", qty: 15 }, { warehouse: "C", qty: 35 } ] }\n]);\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h2",{attrs:{id:"返回匹配文档中的所有字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#返回匹配文档中的所有字段"}},[s._v("#")]),s._v(" 返回匹配文档中的所有字段")]),s._v(" "),a("p",[s._v("如果未指定投影文档，db.collection.find（）方法将返回匹配文档中的所有字段。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { status: "A" } ).pretty()\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a92"),\n        "item" : "journal",\n        "status" : "A",\n        "size" : {\n                "h" : 14,\n                "w" : 21,\n                "uom" : "cm"\n        },\n        "instock" : [\n                {\n                        "warehouse" : "A",\n                        "qty" : 5\n                }\n        ]\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a93"),\n        "item" : "notebook",\n        "status" : "A",\n        "size" : {\n                "h" : 8.5,\n                "w" : 11,\n                "uom" : "in"\n        },\n        "instock" : [\n                {\n                        "warehouse" : "C",\n                        "qty" : 5\n                }\n        ]\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a96"),\n        "item" : "postcard",\n        "status" : "A",\n        "size" : {\n                "h" : 10,\n                "w" : 15.25,\n                "uom" : "cm"\n        },\n        "instock" : [\n                {\n                        "warehouse" : "B",\n                        "qty" : 15\n                },\n                {\n                        "warehouse" : "C",\n                        "qty" : 35\n                }\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br")])]),a("p",[s._v("该操作对应于以下 SQL 语句：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('SELECT * from inventory WHERE status = "A"\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("以下示例返回库存集合中状态为“A”的所有文档中的所有字段：")]),s._v(" "),a("h2",{attrs:{id:"仅返回指定字段和-id-字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#仅返回指定字段和-id-字段"}},[s._v("#")]),s._v(" 仅返回指定字段和_id 字段")]),s._v(" "),a("p",[s._v("通过在投影文档中将"),a("code",[s._v("<field>")]),s._v("设置为 1，投影可以显式包括多个字段。以下操作返回与查询匹配的所有文档。在结果集中，匹配文档中仅返回项目、状态以及默认情况下的_id 字段。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { status: "A" }, { item: 1, status: 1 } ).pretty()\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a92"),\n        "item" : "journal",\n        "status" : "A"\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a93"),\n        "item" : "notebook",\n        "status" : "A"\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a96"),\n        "item" : "postcard",\n        "status" : "A"\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("该操作对应于以下 SQL 语句：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('SELECT _id, item, status from inventory WHERE status = "A"\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"隐藏-id-字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#隐藏-id-字段"}},[s._v("#")]),s._v(" 隐藏 id 字段")]),s._v(" "),a("p",[s._v("通过在投影中将_id 字段设置为 0，可以从结果中删除该字段，如下例所示：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { status: "A" }, { item: 1, status: 1, _id: 0 } ).pretty()\n{ "item" : "journal", "status" : "A" }\n{ "item" : "notebook", "status" : "A" }\n{ "item" : "postcard", "status" : "A" }\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("该操作对应于以下 SQL 语句：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('ELECT item, status from inventory WHERE status = "A"\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("blockquote",[a("p",[s._v("除了_id 字段之外，您不能在投影文档中组合包含和排除语句。")])]),s._v(" "),a("h2",{attrs:{id:"返回除排除字段外的所有字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#返回除排除字段外的所有字段"}},[s._v("#")]),s._v(" 返回除排除字段外的所有字段")]),s._v(" "),a("p",[s._v("您可以使用投影排除特定字段，而不是在匹配文档中列出要返回的字段。以下示例返回匹配文档中除 status 和 instock 字段外的所有字段：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { status: "A" }, { status: 0, instock: 0 } ).pretty()\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a92"),\n        "item" : "journal",\n        "size" : {\n                "h" : 14,\n                "w" : 21,\n                "uom" : "cm"\n        }\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a93"),\n        "item" : "notebook",\n        "size" : {\n                "h" : 8.5,\n                "w" : 11,\n                "uom" : "in"\n        }\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a96"),\n        "item" : "postcard",\n        "size" : {\n                "h" : 10,\n                "w" : 15.25,\n                "uom" : "cm"\n        }\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("h2",{attrs:{id:"返回嵌入文档中的特定字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#返回嵌入文档中的特定字段"}},[s._v("#")]),s._v(" 返回嵌入文档中的特定字段")]),s._v(" "),a("p",[s._v("可以在嵌入文档中返回特定字段。使用点表示法引用嵌入字段，并在投影文档中设置为 1。")]),s._v(" "),a("p",[s._v("以下示例返回：")]),s._v(" "),a("ul",[a("li",[s._v("_id 字段（默认返回）")]),s._v(" "),a("li",[s._v("item 字段")]),s._v(" "),a("li",[s._v("status 字段")]),s._v(" "),a("li",[s._v("size.umo 字段。")])]),s._v(" "),a("p",[s._v("umo 字段仍嵌入在 size 文档中。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find(\n    { status: "A" },\n    { item: 1, status: 1, "size.uom": 1 }\n ).pretty()\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a92"),\n        "item" : "journal",\n        "status" : "A",\n        "size" : {\n                "uom" : "cm"\n        }\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a93"),\n        "item" : "notebook",\n        "status" : "A",\n        "size" : {\n                "uom" : "in"\n        }\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a96"),\n        "item" : "postcard",\n        "status" : "A",\n        "size" : {\n                "uom" : "cm"\n        }\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("p",[s._v("从 MongoDB 4.4 开始，您还可以使用嵌套表单指定嵌入式字段，例如:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find(\n     { status: "A" },\n     { item: 1, status: 1, size: { uom: 1 } }\n  ).pretty()\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a92"),\n        "item" : "journal",\n        "status" : "A",\n        "size" : {\n                "uom" : "cm"\n        }\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a93"),\n        "item" : "notebook",\n        "status" : "A",\n        "size" : {\n                "uom" : "in"\n        }\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a96"),\n        "item" : "postcard",\n        "status" : "A",\n        "size" : {\n                "uom" : "cm"\n        }\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("h2",{attrs:{id:"抑制嵌入文档中的特定字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#抑制嵌入文档中的特定字段"}},[s._v("#")]),s._v(" 抑制嵌入文档中的特定字段")]),s._v(" "),a("p",[s._v("可以抑制嵌入文档中的特定字段。使用点表示法引用投影文档中的嵌入字段，并设置为 0。")]),s._v(" "),a("p",[s._v("以下示例指定一个投影，以排除尺寸文档中的计量单位字段。所有其他字段将在匹配文档中返回：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find(\n...    { status: "A" },\n...    { "size.uom": 0 }\n... ).pretty()\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a92"),\n        "item" : "journal",\n        "status" : "A",\n        "size" : {\n                "h" : 14,\n                "w" : 21\n        },\n        "instock" : [\n                {\n                        "warehouse" : "A",\n                        "qty" : 5\n                }\n        ]\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a93"),\n        "item" : "notebook",\n        "status" : "A",\n        "size" : {\n                "h" : 8.5,\n                "w" : 11\n        },\n        "instock" : [\n                {\n                        "warehouse" : "C",\n                        "qty" : 5\n                }\n        ]\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a96"),\n        "item" : "postcard",\n        "status" : "A",\n        "size" : {\n                "h" : 10,\n                "w" : 15.25\n        },\n        "instock" : [\n                {\n                        "warehouse" : "B",\n                        "qty" : 15\n                },\n                {\n                        "warehouse" : "C",\n                        "qty" : 35\n                }\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br")])]),a("p",[s._v("从 MongoDB 4.4 开始，还可以使用嵌套形式指定嵌入字段，例如：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find(\n...    { status: "A" },\n...    { size: { uom: 0 } }\n... ).pretty()\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a92"),\n        "item" : "journal",\n        "status" : "A",\n        "size" : {\n                "h" : 14,\n                "w" : 21\n        },\n        "instock" : [\n                {\n                        "warehouse" : "A",\n                        "qty" : 5\n                }\n        ]\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a93"),\n        "item" : "notebook",\n        "status" : "A",\n        "size" : {\n                "h" : 8.5,\n                "w" : 11\n        },\n        "instock" : [\n                {\n                        "warehouse" : "C",\n                        "qty" : 5\n                }\n        ]\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a96"),\n        "item" : "postcard",\n        "status" : "A",\n        "size" : {\n                "h" : 10,\n                "w" : 15.25\n        },\n        "instock" : [\n                {\n                        "warehouse" : "B",\n                        "qty" : 15\n                },\n                {\n                        "warehouse" : "C",\n                        "qty" : 35\n                }\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br")])]),a("h2",{attrs:{id:"数组中嵌入文档的投影"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数组中嵌入文档的投影"}},[s._v("#")]),s._v(" 数组中嵌入文档的投影")]),s._v(" "),a("p",[s._v("使用点表示法在嵌入数组的文档中投影特定字段。")]),s._v(" "),a("p",[s._v("以下示例指定要返回的投影：")]),s._v(" "),a("ul",[a("li",[s._v("_id 字段（默认返回）")]),s._v(" "),a("li",[s._v("item 字段")]),s._v(" "),a("li",[s._v("status 字段")]),s._v(" "),a("li",[s._v("instock.qty 字段。")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { status: "A" }, { item: 1, status: 1, "instock.qty": 1 } ).pretty()\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a92"),\n        "item" : "journal",\n        "status" : "A",\n        "instock" : [\n                {\n                        "qty" : 5\n                }\n        ]\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a93"),\n        "item" : "notebook",\n        "status" : "A",\n        "instock" : [\n                {\n                        "qty" : 5\n                }\n        ]\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a96"),\n        "item" : "postcard",\n        "status" : "A",\n        "instock" : [\n                {\n                        "qty" : 15\n                },\n                {\n                        "qty" : 35\n                }\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br")])]),a("h2",{attrs:{id:"返回数组中特定于项目的数组元素"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#返回数组中特定于项目的数组元素"}},[s._v("#")]),s._v(" 返回数组中特定于项目的数组元素")]),s._v(" "),a("p",[s._v("对于包含数组的字段，MongoDB 提供以下用于操作数组的投影操作符："),a("code",[s._v("$elemMatch")]),s._v("、"),a("code",[s._v("$slice")]),s._v("和"),a("code",[s._v("$")]),s._v("。\n以下示例使用"),a("code",[s._v("$slice")]),s._v(" 投影操作符返回 instock 数组中的最后一个元素：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { status: "A" }, { item: 1, status: 1, instock: { $slice: -1 } } ).pretty()\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a92"),\n        "item" : "journal",\n        "status" : "A",\n        "instock" : [\n                {\n                        "warehouse" : "A",\n                        "qty" : 5\n                }\n        ]\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a93"),\n        "item" : "notebook",\n        "status" : "A",\n        "instock" : [\n                {\n                        "warehouse" : "C",\n                        "qty" : 5\n                }\n        ]\n}\n{\n        "_id" : ObjectId("6130721a61e58538d1d25a96"),\n        "item" : "postcard",\n        "status" : "A",\n        "instock" : [\n                {\n                        "warehouse" : "C",\n                        "qty" : 35\n                }\n        ]\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br")])]),a("p",[a("code",[s._v("$elemMatch")]),s._v("、"),a("code",[s._v("$slice")]),s._v("和"),a("code",[s._v("$")]),s._v("是将特定元素投影到返回数组中的唯一方法。例如，不能使用数组索引投影特定数组元素；例如：{“instock.0”：1}投影将不会投影具有第一个元素的数组。")]),s._v(" "),a("h2",{attrs:{id:"其他考虑事项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他考虑事项"}},[s._v("#")]),s._v(" 其他考虑事项")]),s._v(" "),a("p",[s._v("从 MongoDB 4.4 开始，MongoDB 对投影实施额外的限制。有关详细信息，请参见"),a("a",{attrs:{href:"https://docs.mongodb.com/v4.4/reference/limits/#mongodb-limit-Projection-Restrictions",target:"_blank",rel:"noopener noreferrer"}},[s._v("投影限制"),a("OutboundLink")],1),s._v("。")]),s._v(" "),a("h2",{attrs:{id:"查询空字段或缺少字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询空字段或缺少字段"}},[s._v("#")]),s._v(" 查询空字段或缺少字段")]),s._v(" "),a("p",[s._v("MongoDB 中的不同查询运算符对空值的处理方式不同。")]),s._v(" "),a("p",[s._v("插入数据")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.inventory.insertMany([\n   { _id: 1, item: null },\n   { _id: 2 }\n])\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"相等过滤器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#相等过滤器"}},[s._v("#")]),s._v(" 相等过滤器")]),s._v(" "),a("p",[s._v("{item:null}查询匹配包含值为 null 的 item 字段或不包含 item 字段的文档。")]),s._v(" "),a("p",[s._v("查询将返回集合中的两个文档。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { item: null } )\n{ "_id" : 1, "item" : null }\n{ "_id" : 2 }\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"类型检查"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#类型检查"}},[s._v("#")]),s._v(" 类型检查")]),s._v(" "),a("p",[s._v("{item:{$type:10}}}查询只匹配包含值为 null 的 item 字段的文档；.项目字段的值为 BSON 类型 Null（类型编号 10）：")]),s._v(" "),a("p",[s._v("查询仅返回项目字段值为 null 的文档。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { item : { $type: 10 } } )\n{ "_id" : 1, "item" : null }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("从 MongoDB 4.2 开始，用户不能再将查询筛选器"),a("code",[s._v("$type:0")]),s._v("用作"),a("code",[s._v("$exists:false")]),s._v("的同义词。要查询空字段或缺少的字段，请参阅"),a("a",{attrs:{href:"https://docs.mongodb.com/v4.4/tutorial/query-for-null-fields/",target:"_blank",rel:"noopener noreferrer"}},[s._v("查询空字段或缺少的字段"),a("OutboundLink")],1),s._v("。")]),s._v(" "),a("h2",{attrs:{id:"存在性检查"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#存在性检查"}},[s._v("#")]),s._v(" 存在性检查")]),s._v(" "),a("p",[s._v("以下示例查询不包含字段的文档")]),s._v(" "),a("p",[s._v("{item:{$exists:false}}查询匹配不包含 item 字段的文档：\n查询只返回不包含项目字段的文档。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.inventory.find( { item : { $exists: false } } )\n{ "_id" : 2 }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("blockquote",[a("p",[a("a",{attrs:{href:"https://docs.mongodb.com/v4.4/reference/operator/query/type/#mongodb-query-op.-type",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("$type")]),a("OutboundLink")],1),s._v("和"),a("a",{attrs:{href:"https://docs.mongodb.com/v4.4/reference/operator/query/exists/#mongodb-query-op.-exists",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("$exists")]),a("OutboundLink")],1),s._v("运算符的参考文档。")])]),s._v(" "),a("h2",{attrs:{id:"更新文档-update-方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更新文档-update-方法"}},[s._v("#")]),s._v(" 更新文档 update() 方法")]),s._v(" "),a("p",[a("code",[s._v("update()")]),s._v(" 方法用于更新已存在的文档。语法格式如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.collection.update(\n   <query>,\n   <update>,\n   {\n     upsert: <boolean>,\n     multi: <boolean>,\n     writeConcern: <document>\n   }\n)\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("参数说明：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("query")]),s._v(" : update 的查询条件，类似 sql update 查询内 where 后面的。")]),s._v(" "),a("li",[a("code",[s._v("update")]),s._v(" : update 的对象和一些更新的操作符（如$,$inc...）等，也可以理解为 sql update 查询内 set 后面的")]),s._v(" "),a("li",[a("code",[s._v("upsert")]),s._v(" : 可选，这个参数的意思是，如果不存在 update 的记录，是否插入 objNew,true 为插入，默认是 false，不插入。")]),s._v(" "),a("li",[a("code",[s._v("multi")]),s._v(" : 可选，mongodb 默认是 false,只更新找到的第一条记录，如果这个参数为 true,就把按条件查出来多条记录全部更新。")]),s._v(" "),a("li",[a("code",[s._v("writeConcern")]),s._v(" :可选，抛出异常的级别。")])]),s._v(" "),a("h2",{attrs:{id:"实例-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例-4"}},[s._v("#")]),s._v(" 实例")]),s._v(" "),a("p",[s._v("在集合中插入如下数据：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("> db.col.insert({title:'MongoDB 教程',description:'MongoDB 是一个Nosql 数据库',by:'zzl',url:'http://10.8.103.47:9000',tags:['mongodb','database','NoSQL'],likes:100})\nWriteResult({ \"nInserted\" : 1 })\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("接着我们通过 update() 方法来更新标题(title):")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.update({title:\'MongoDB 教程\'},{$set:{title:\'MongoDB\'}})\nWriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })\n> db.col.find().pretty()\n{\n        "_id" : ObjectId("612f3c85220ce5ce5c2b4cc5"),\n        "title" : "MongoDB",\n        "description" : "MongoDB 是一个Nosql 数据库",\n        "by" : "zzl",\n        "url" : "http://10.8.103.47:9000",\n        "tags" : [\n                "mongodb",\n                "database",\n                "NoSQL"\n        ],\n        "likes" : 100\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v('可以看到标题(title)由原来的 "MongoDB 教程" 更新为了 "MongoDB"。')]),s._v(" "),a("p",[s._v("以上语句只会修改第一条发现的文档，如果你要修改多条相同的文档，则需要设置 multi 参数为 true。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(">db.col.update({'title':'MongoDB 教程'},{$set:{'title':'MongoDB'}},{multi:true})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"save-方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#save-方法"}},[s._v("#")]),s._v(" save() 方法")]),s._v(" "),a("p",[a("code",[s._v("save()")]),s._v(" 方法通过传入的文档来替换已有文档，"),a("code",[s._v("_id")]),s._v(" 主键存在就更新，不存在就插入。语法格式如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.collection.save(\n   <document>,\n   {\n     writeConcern: <document>\n   }\n)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("参数说明：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("document")]),s._v(" : 文档数据。")]),s._v(" "),a("li",[a("code",[s._v("writeConcern")]),s._v(" :可选，抛出异常的级别。")])]),s._v(" "),a("h2",{attrs:{id:"实例-5"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例-5"}},[s._v("#")]),s._v(" 实例")]),s._v(" "),a("p",[s._v("以下实例中我们替换了 "),a("code",[s._v("_id")]),s._v(" 为 612f428a220ce5ce5c2b4cc7 的文档数据：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('>db.col.save({\n        "_id" : ObjectId("612f428a220ce5ce5c2b4cc7"),\n        "title" : "MongoDB 教程",\n        "description" : "MongoDB 是一个Nosql 数据库",\n        "by" : "zzl",\n        "url" : "http://10.8.103.47:9000",\n        "tags" : [\n                "mongodb",\n                "database",\n                "NoSQL"\n        ],\n        "likes" : 102\n})\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("替换成功后，我们可以通过 "),a("code",[s._v("find()")]),s._v(" 命令来查看替换后的数据")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.save({\n...         "_id" : ObjectId("612f428a220ce5ce5c2b4cc7"),\n...         "title" : "MongoDB 教程",\n...         "description" : "MongoDB 是一个Nosql 数据库",\n...         "by" : "zzl",\n...         "url" : "http://10.8.103.47:9000",\n...         "tags" : [\n...                 "mongodb",\n...                 "database",\n...                 "NoSQL"\n...         ],\n...         "likes" : 102\n... })\nWriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })\n> db.col.find().pretty()\n{\n        "_id" : ObjectId("612f3c85220ce5ce5c2b4cc5"),                                                        : 102 })\n        "title" : "MongoDB",\n        "description" : "MongoDB 是一个Nosql 数据库",\n        "by" : "zzl",\n        "url" : "http://10.8.103.47:9000",\n        "tags" : [\n                "mongodb",\n                "database",\n                "NoSQL"\n        ],\n        "likes" : 100\n}\n{\n        "_id" : ObjectId("612f4283220ce5ce5c2b4cc6"),\n        "title" : "MongoDB",\n        "description" : "MongoDB 是一个Nosql 数据库",\n        "by" : "zzl",\n        "url" : "http://10.8.103.47:9000",\n        "tags" : [\n                "mongodb",\n                "database",\n                "NoSQL"\n        ],\n        "likes" : 101\n}\n{\n        "_id" : ObjectId("612f428a220ce5ce5c2b4cc7"),\n        "title" : "MongoDB 教程",\n        "description" : "MongoDB 是一个Nosql 数据库",\n        "by" : "zzl",\n        "url" : "http://10.8.103.47:9000",\n        "tags" : [\n                "mongodb",\n                "database",\n                "NoSQL"\n        ],\n        "likes" : 102\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br")])]),a("h2",{attrs:{id:"更多实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更多实例"}},[s._v("#")]),s._v(" 更多实例")]),s._v(" "),a("p",[s._v("只更新第一条记录：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('db.col.update( { "count" : { $gt : 1 } } , { $set : { "test2" : "OK"} } );\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("全部更新：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('db.col.update( { "count" : { $gt : 3 } } , { $set : { "test2" : "OK"} },false,true );\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("只添加第一条：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('db.col.update( { "count" : { $gt : 4 } } , { $set : { "test5" : "OK"} },true,false );\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("全部添加进去:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('db.col.update( { "count" : { $gt : 5 } } , { $set : { "test5" : "OK"} },true,true );\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("全部更新：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('db.col.update( { "count" : { $gt : 15 } } , { $inc : { "count" : 1} },false,true );\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("只更新第一条记录：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('db.col.update( { "count" : { $gt : 10 } } , { $inc : { "count" : 1} },false,false );\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"删除文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除文档"}},[s._v("#")]),s._v(" 删除文档")]),s._v(" "),a("p",[a("code",[s._v("remove()")]),s._v(" 方法的基本语法格式如下所示：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.collection.remove(\n   <query>,\n   <justOne>\n)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("如果你的 MongoDB 是 2.6 版本以后的，语法格式如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.collection.remove(\n   <query>,\n   {\n     justOne: <boolean>,\n     writeConcern: <document>\n   }\n)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("参数说明：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("query")]),s._v(" :（可选）删除的文档的条件。")]),s._v(" "),a("li",[a("code",[s._v("justOne")]),s._v(" : （可选）如果设为 true 或 1，则只删除一个文档，如果不设置该参数，或使用默认值 false，则删除所有匹配条件的文档。")]),s._v(" "),a("li",[a("code",[s._v("writeConcern")]),s._v(" :（可选）抛出异常的级别。")])]),s._v(" "),a("h2",{attrs:{id:"实例-6"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例-6"}},[s._v("#")]),s._v(" 实例")]),s._v(" "),a("p",[s._v("以下文档我们执行两次插入操作：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(">db.col.insert({title: 'MongoDB 教程',\n    description: 'MongoDB 是一个 Nosql 数据库',\n    by: 'zzl',\n    url: 'http://10.8.103.47:9000',\n    tags: ['mongodb', 'database', 'NoSQL'],\n    likes: 100\n})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("使用 find() 函数查询数据：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find().pretty()\n{                                                                        : 100 })\n        "_id" : ObjectId("612f4627220ce5ce5c2b4cca"),\n        "title" : "MongoDB 教程",\n        "description" : "MongoDB 是一个 Nosql 数据库",\n        "by" : "zzl",\n        "url" : "http://10.8.103.47:9000",\n        "tags" : [\n                "mongodb",\n                "database",\n                "NoSQL"\n        ],\n        "likes" : 100\n}\n{\n        "_id" : ObjectId("612f4628220ce5ce5c2b4ccb"),\n        "title" : "MongoDB 教程",\n        "description" : "MongoDB 是一个 Nosql 数据库",\n        "by" : "zzl",\n        "url" : "http://10.8.103.47:9000",\n        "tags" : [\n                "mongodb",\n                "database",\n                "NoSQL"\n        ],\n        "likes" : 100\n}\n>\n\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("p",[s._v("接下来我们移除 title 为 'MongoDB 教程' 的文档：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("> db.col.remove({'title':'MongoDB 教程'})\nWriteResult({ \"nRemoved\" : 2 })                 # 删除了两条数据\n> db.col.find().pretty()               })\n>                                               # 没有数据\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("如果你只想删除第一条找到的记录可以设置 justOne 为 1，如下所示：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(">db.COLLECTION_NAME.remove(DELETION_CRITERIA,1)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("如果你想删除所有数据，可以使用以下方式（类似常规 SQL 的 truncate 命令）：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(">db.col.remove({})\n>db.col.find()\n>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"remove-方法已经过时了-现在官方推荐使用-deleteone-和-deletemany-方法。-但是-remove-也可以用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#remove-方法已经过时了-现在官方推荐使用-deleteone-和-deletemany-方法。-但是-remove-也可以用"}},[s._v("#")]),s._v(" remove() 方法已经过时了，现在官方推荐使用 deleteOne() 和 deleteMany() 方法。 但是 remove()也可以用")]),s._v(" "),a("p",[s._v("如删除集合下全部文档：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.inventory.deleteMany({})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("删除 status 等于 A 的全部文档：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('db.inventory.deleteMany({ status : "A" })\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("删除 status 等于 D 的一个文档：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('db.inventory.deleteOne( { status: "D" } )\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"mongodb-条件操作符"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-条件操作符"}},[s._v("#")]),s._v(" MongoDB 条件操作符")]),s._v(" "),a("p",[s._v("条件操作符用于比较两个表达式并从 mongoDB 集合中获取数据。")]),s._v(" "),a("p",[s._v("在本章节中，我们将讨论如何在 MongoDB 中使用条件操作符。")]),s._v(" "),a("p",[s._v("MongoDB 中条件操作符有：")]),s._v(" "),a("ul",[a("li",[s._v("(>) 大于 - $gt")]),s._v(" "),a("li",[s._v("(<) 小于 - $lt")]),s._v(" "),a("li",[s._v("(>=) 大于等于 - $gte")]),s._v(" "),a("li",[s._v("(<= ) 小于等于 - $lte")]),s._v(" "),a("li",[s._v("(!= ) 不等于 - $ne\n"),a("strong",[s._v('我们使用的数据库名称为"test" 我们的集合名称为"col"，以下为我们插入的数据。')])])]),s._v(" "),a("p",[s._v('为了方便测试，我们可以先使用以下命令清空集合 "col" 的数据：')]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.col.remove({})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("插入以下数据")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(">db.col.insert({\n    title: 'PHP 教程',\n    description: 'PHP 是一种创建动态交互性站点的强有力的服务器端脚本语言。',\n    by: '菜鸟教程',\n    url: 'http://www.runoob.com',\n    tags: ['php'],\n    likes: 200\n})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(">db.col.insert({title: 'Java 教程',\n    description: 'Java 是由Sun Microsystems公司于1995年5月推出的高级程序设计语言。',\n    by: '菜鸟教程',\n    url: 'http://www.runoob.com',\n    tags: ['java'],\n    likes: 150\n})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(">db.col.insert({title: 'MongoDB 教程',\n    description: 'MongoDB 是一个 Nosql 数据库',\n    by: '菜鸟教程',\n    url: 'http://www.runoob.com',\n    tags: ['mongodb'],\n    likes: 100\n})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("使用 find()命令查看数据：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find().pretty()\n{\n        "_id" : ObjectId("613034ccca9da47b9eb3a80a"),\n        "title" : "PHP 教程",\n        "description" : "PHP 是一种创建动态交互性站点的强有力的服务器端脚本语言。",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "php"\n        ],\n        "likes" : 200\n}\n{\n        "_id" : ObjectId("613034e4ca9da47b9eb3a80b"),\n        "title" : "Java 教程",\n        "description" : "Java 是由Sun Microsystems公司于1995年5月推出的高级程序设计语言。",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "java"\n        ],\n        "likes" : 150\n}\n{\n        "_id" : ObjectId("613034ebca9da47b9eb3a80c"),\n        "title" : "MongoDB 教程",\n        "description" : "MongoDB 是一个 Nosql 数据库",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "mongodb"\n        ],\n        "likes" : 100\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br")])]),a("h2",{attrs:{id:"mongodb-大于操作符-gt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-大于操作符-gt"}},[s._v("#")]),s._v(" MongoDB (>) 大于操作符 - $gt")]),s._v(" "),a("p",[s._v('如果你想获取 "col" 集合中 "likes" 大于 100 的数据，你可以使用以下命令：')]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.col.find({likes : {$gt : 100}})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("类似于 SQL 语句：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Select * from col where likes > 100;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("输出结果：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find({likes : {$gt : 100}}).pretty()\n{\n        "_id" : ObjectId("613034ccca9da47b9eb3a80a"),\n        "title" : "PHP 教程",\n        "description" : "PHP 是一种创建动态交互性站点的强有力的服务器端脚本语言。",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "php"\n        ],\n        "likes" : 200\n}\n{\n        "_id" : ObjectId("613034e4ca9da47b9eb3a80b"),\n        "title" : "Java 教程",\n        "description" : "Java 是由Sun Microsystems公司于1995年5月推出的高级程序设计语言。",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "java"\n        ],\n        "likes" : 150\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h3",{attrs:{id:"mongodb-大于等于操作符-gte"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-大于等于操作符-gte"}},[s._v("#")]),s._v(" MongoDB（>=）大于等于操作符 - $gte")]),s._v(" "),a("p",[s._v('如果你想获取"col"集合中 "likes" 大于等于 100 的数据，你可以使用以下命令：')]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.col.find({likes : {$gte : 100}})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("类似于 SQL 语句：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Select * from col where likes >=100;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("输出结果：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find({likes : {$gte : 100}}).pretty()\n{\n        "_id" : ObjectId("613034ccca9da47b9eb3a80a"),\n        "title" : "PHP 教程",\n        "description" : "PHP 是一种创建动态交互性站点的强有力的服务器端脚本语言。",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "php"\n        ],\n        "likes" : 200\n}\n{\n        "_id" : ObjectId("613034e4ca9da47b9eb3a80b"),\n        "title" : "Java 教程",\n        "description" : "Java 是由Sun Microsystems公司于1995年5月推出的高级程序设计语言。",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "java"\n        ],\n        "likes" : 150\n}\n{\n        "_id" : ObjectId("613034ebca9da47b9eb3a80c"),\n        "title" : "MongoDB 教程",\n        "description" : "MongoDB 是一个 Nosql 数据库",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "mongodb"\n        ],\n        "likes" : 100\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br")])]),a("h2",{attrs:{id:"mongodb-小于操作符-lt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-小于操作符-lt"}},[s._v("#")]),s._v(" MongoDB (<) 小于操作符 - $lt")]),s._v(" "),a("p",[s._v('如果你想获取"col"集合中 "likes" 小于 150 的数据，你可以使用以下命令：')]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.col.find({likes : {$lt : 150}})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("类似于 SQL 语句：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Select * from col where likes < 150;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("输出结果：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find({likes : {$lt : 150}}).pretty()\n{\n        "_id" : ObjectId("613034ebca9da47b9eb3a80c"),\n        "title" : "MongoDB 教程",\n        "description" : "MongoDB 是一个 Nosql 数据库",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "mongodb"\n        ],\n        "likes" : 100\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h2",{attrs:{id:"mongodb-小于等于操作符-lte"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-小于等于操作符-lte"}},[s._v("#")]),s._v(" MongoDB (<=) 小于等于操作符 - $lte")]),s._v(" "),a("p",[s._v('如果你想获取"col"集合中 "likes" 小于等于 150 的数据，你可以使用以下命令：')]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.col.find({likes : {$lte : 150}})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("类似于 SQL 语句：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Select * from col where likes <= 150;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("输出结果：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find({likes : {$lte : 150}}).pretty()\n{\n        "_id" : ObjectId("613034e4ca9da47b9eb3a80b"),\n        "title" : "Java 教程",\n        "description" : "Java 是由Sun Microsystems公司于1995年5月推出的高级程序设计语言。",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "java"\n        ],\n        "likes" : 150\n}\n{\n        "_id" : ObjectId("613034ebca9da47b9eb3a80c"),\n        "title" : "MongoDB 教程",\n        "description" : "MongoDB 是一个 Nosql 数据库",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "mongodb"\n        ],\n        "likes" : 100\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h2",{attrs:{id:"mongodb-使用-和-查询-lt-和-gt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-使用-和-查询-lt-和-gt"}},[s._v("#")]),s._v(" MongoDB 使用 (<) 和 (>) 查询 - $lt 和 $gt")]),s._v(" "),a("p",[s._v('如果你想获取"col"集合中 "likes" 大于 100，小于 200 的数据，你可以使用以下命令：')]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.col.find({likes : {$lt :200, $gt : 100}})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("类似于 SQL 语句：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Select * from col where likes>100 AND  likes<200;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("输出结果：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find({likes : {$lt :200, $gt : 100}}).pretty()\n{\n        "_id" : ObjectId("613034e4ca9da47b9eb3a80b"),\n        "title" : "Java 教程",\n        "description" : "Java 是由Sun Microsystems公司于1995年5月推出的高级程序设计语言。",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "java"\n        ],\n        "likes" : 150\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h2",{attrs:{id:"mongodb-type-操作符"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-type-操作符"}},[s._v("#")]),s._v(" MongoDB "),a("code",[s._v("$type")]),s._v(" 操作符")]),s._v(" "),a("p",[s._v("在本章节中，我们将继续讨论 MongoDB 中条件操作符 "),a("code",[s._v("$type")]),s._v("。")]),s._v(" "),a("p",[a("code",[s._v("$type")]),s._v("操作符是基于 BSON 类型来检索集合中匹配的数据类型，并返回结果。")]),s._v(" "),a("p",[s._v("MongoDB 中可以使用的类型如下表所示：")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("类型")]),s._v(" "),a("th",[s._v("数字")]),s._v(" "),a("th",[s._v("备注")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("Double")]),s._v(" "),a("td",[s._v("1")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("String")]),s._v(" "),a("td",[s._v("2")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("Object")]),s._v(" "),a("td",[s._v("3")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("Array")]),s._v(" "),a("td",[s._v("4")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("Binary data")]),s._v(" "),a("td",[s._v("5")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("Undefined")]),s._v(" "),a("td",[s._v("6")]),s._v(" "),a("td",[s._v("已废弃。")])]),s._v(" "),a("tr",[a("td",[s._v("Object id")]),s._v(" "),a("td",[s._v("7")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("Boolean")]),s._v(" "),a("td",[s._v("8")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("Date")]),s._v(" "),a("td",[s._v("9")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("Null")]),s._v(" "),a("td",[s._v("10")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("Regular Expression")]),s._v(" "),a("td",[s._v("11")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("JavaScript")]),s._v(" "),a("td",[s._v("13")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("Symbol")]),s._v(" "),a("td",[s._v("14")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("JavaScript (with scope)")]),s._v(" "),a("td",[s._v("15")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("32-bit integer")]),s._v(" "),a("td",[s._v("16")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("Timestamp")]),s._v(" "),a("td",[s._v("17")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("64-bit integer")]),s._v(" "),a("td",[s._v("18")]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[s._v("Min key")]),s._v(" "),a("td",[s._v("255")]),s._v(" "),a("td",[s._v("Query with -1.")])]),s._v(" "),a("tr",[a("td",[s._v("Max key")]),s._v(" "),a("td",[s._v("127")]),s._v(" "),a("td")])])]),s._v(" "),a("h3",{attrs:{id:"mongodb-操作符-type-实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-操作符-type-实例"}},[s._v("#")]),s._v(" MongoDB 操作符 - $type 实例")]),s._v(" "),a("p",[s._v('如果想获取 "col" 集合中 title 为 String 的数据，你可以使用以下命令：')]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('db.col.find({"title" : {$type : 2}})\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("或")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.col.find({\"title\" : {$type : 'string'}})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("输出结果为：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find({"title" : {$type : 2}}).pretty()\n{\n        "_id" : ObjectId("613034ccca9da47b9eb3a80a"),\n        "title" : "PHP 教程",\n        "description" : "PHP 是一种创建动态交互性站点的强有力的服务器端脚本语言。",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "php"\n        ],\n        "likes" : 200\n}\n{\n        "_id" : ObjectId("613034e4ca9da47b9eb3a80b"),\n        "title" : "Java 教程",\n        "description" : "Java 是由Sun Microsystems公司于1995年5月推出的高级程序设计语言。",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "java"\n        ],\n        "likes" : 150\n}\n{\n        "_id" : ObjectId("613034ebca9da47b9eb3a80c"),\n        "title" : "MongoDB 教程",\n        "description" : "MongoDB 是一个 Nosql 数据库",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "mongodb"\n        ],\n        "likes" : 100\n}\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br")])]),a("h2",{attrs:{id:"mongodb-limit-与-skip-方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-limit-与-skip-方法"}},[s._v("#")]),s._v(" MongoDB Limit 与 Skip 方法")]),s._v(" "),a("h3",{attrs:{id:"mongodb-limit-方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-limit-方法"}},[s._v("#")]),s._v(" MongoDB Limit() 方法")]),s._v(" "),a("p",[s._v("如果你需要在 MongoDB 中读取指定数量的数据记录，可以使用 MongoDB 的 Limit 方法，limit()方法接受一个数字参数，该参数指定从 MongoDB 中读取的记录条数。")]),s._v(" "),a("h3",{attrs:{id:"语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#语法"}},[s._v("#")]),s._v(" 语法")]),s._v(" "),a("p",[s._v("limit()方法基本语法如下所示：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(">db.COLLECTION_NAME.find().limit(NUMBER)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("示例：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find({},{"title":1,_id:0}).limit(2).pretty()\n{ "title" : "PHP 教程" }\n{ "title" : "Java 教程" }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"mongodb-skip-方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-skip-方法"}},[s._v("#")]),s._v(" MongoDB Skip() 方法")]),s._v(" "),a("p",[s._v("我们除了可以使用 limit()方法来读取指定数量的数据外，还可以使用 skip()方法来跳过指定数量的数据，skip 方法同样接受一个数字参数作为跳过的记录条数。\n语法\nskip() 方法脚本语法格式如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("> db.COLLECTION_NAME.find().limit(NUMBER).skip(NUMBER)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("实例\n以下实例只会显示第二条文档数据")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find({},{"title":1,_id:0}).limit(1).skip(1).pretty()\n{ "title" : "Java 教程" }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"mongodb-排序-sort-方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-排序-sort-方法"}},[s._v("#")]),s._v(" MongoDB 排序 sort() 方法")]),s._v(" "),a("p",[s._v("在 MongoDB 中使用 sort() 方法对数据进行排序，sort() 方法可以通过参数指定排序的字段，并使用 1 和 -1 来指定排序的方式，其中 1 为升序排列，而 -1 是用于降序排列。")]),s._v(" "),a("p",[s._v("语法\nsort()方法基本语法如下所示：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(">db.COLLECTION_NAME.find().sort({KEY:1})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("以下实例演示了 col 集合中的数据按字段 likes 的降序排列：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.find({},{"title":1,_id:0}).sort({"likes":-1})\n{ "title" : "PHP 教程" }\n{ "title" : "Java 教程" }\n{ "title" : "MongoDB 教程" }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("strong",[s._v("skip(), limilt(), sort()三个放在一起执行的时候，执行的顺序是先 sort(), 然后是 skip()，最后是显示的 limit()。")])]),s._v(" "),a("h2",{attrs:{id:"mongodb-索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-索引"}},[s._v("#")]),s._v(" MongoDB 索引")]),s._v(" "),a("p",[s._v("索引通常能够极大的提高查询的效率，如果没有索引，MongoDB 在读取数据时必须扫描集合中的每个文件并选取那些符合查询条件的记录。")]),s._v(" "),a("p",[s._v("这种扫描全集合的查询效率是非常低的，特别在处理大量的数据时，查询可以要花费几十秒甚至几分钟，这对网站的性能是非常致命的。")]),s._v(" "),a("p",[s._v("索引是特殊的数据结构，索引存储在一个易于遍历读取的数据集合中，索引是对数据库表中一列或多列的值进行排序的一种结构")]),s._v(" "),a("h2",{attrs:{id:"createindex-方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#createindex-方法"}},[s._v("#")]),s._v(" createIndex() 方法")]),s._v(" "),a("p",[s._v("MongoDB 使用 createIndex() 方法来创建索引。")]),s._v(" "),a("blockquote",[a("p",[s._v("注意在 3.0.0 版本前创建索引方法为 db.collection.ensureIndex()，之后的版本使用了 db.collection.createIndex() 方法，ensureIndex() 还能用，但只是 createIndex() 的别名。")])]),s._v(" "),a("h3",{attrs:{id:"语法-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#语法-2"}},[s._v("#")]),s._v(" 语法")]),s._v(" "),a("p",[s._v("createIndex()方法基本语法格式如下所示：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(">db.collection.createIndex(keys, options)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("语法中 Key 值为你要创建的索引字段，1 为指定按升序创建索引，如果你想按降序来创建索引指定为 -1 即可。")]),s._v(" "),a("p",[s._v("实例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('>db.col.createIndex({"title":1})\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("createIndex() 方法中你也可以设置使用多个字段创建索引（关系型数据库中称作复合索引）。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('>db.col.createIndex({"title":1,"description":-1})\n>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("createIndex() 接收可选参数，可选参数列表如下：")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("Parameter")]),s._v(" "),a("th",[s._v("Type")]),s._v(" "),a("th",[s._v("Description")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("background")]),s._v(" "),a("td",[s._v("Boolean")]),s._v(" "),a("td",[s._v('建索引过程会阻塞其它数据库操作，background 可指定以后台方式创建索引，即增加 "background" 可选参数。 "background" 默认值为 false。')])]),s._v(" "),a("tr",[a("td",[s._v("unique")]),s._v(" "),a("td",[s._v("Boolean")]),s._v(" "),a("td",[s._v("建立的索引是否唯一。指定为 true 创建唯一索引。默认值为 false.")])]),s._v(" "),a("tr",[a("td",[s._v("name")]),s._v(" "),a("td",[s._v("string")]),s._v(" "),a("td",[s._v("索引的名称。如果未指定，MongoDB 的通过连接索引的字段名和排序顺序生成一个索引名称。")])]),s._v(" "),a("tr",[a("td",[s._v("dropDups")]),s._v(" "),a("td",[s._v("Boolean")]),s._v(" "),a("td",[s._v("3.0+版本已废弃。在建立唯一索引时是否删除重复记录,指定 true 创建唯一索引。默认值为 false.")])]),s._v(" "),a("tr",[a("td",[s._v("sparse")]),s._v(" "),a("td",[s._v("Boolean")]),s._v(" "),a("td",[s._v("对文档中不存在的字段数据不启用索引；这个参数需要特别注意，如果设置为 true 的话，在索引字段中不会查询出不包含对应字段的文档.。默认值为 false.")])]),s._v(" "),a("tr",[a("td",[s._v("expireAfterSeconds")]),s._v(" "),a("td",[s._v("integer")]),s._v(" "),a("td",[s._v("指定一个以秒为单位的数值，完成 TTL 设定，设定集合的生存时间。")])]),s._v(" "),a("tr",[a("td",[s._v("v")]),s._v(" "),a("td",[s._v("index version")]),s._v(" "),a("td",[s._v("索引的版本号。默认的索引版本取决于 mongod 创建索引时运行的版本。")])]),s._v(" "),a("tr",[a("td",[s._v("weights")]),s._v(" "),a("td",[s._v("document")]),s._v(" "),a("td",[s._v("索引权重值，数值在 1 到 99,999 之间，表示该索引相对于其他索引字段的得分权重。")])]),s._v(" "),a("tr",[a("td",[s._v("default_language")]),s._v(" "),a("td",[s._v("string")]),s._v(" "),a("td",[s._v("对于文本索引，该参数决定了停用词及词干和词器的规则的列表。 默认为英语")])]),s._v(" "),a("tr",[a("td",[s._v("language_override")]),s._v(" "),a("td",[s._v("string")]),s._v(" "),a("td",[s._v("对于文本索引，该参数指定了包含在文档中的字段名，语言覆盖默认的 language，默认值为 language.")])])])]),s._v(" "),a("p",[s._v("实例\n在后台创建索引：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.values.createIndex({open: 1, close: 1}, {background: true})\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("通过在创建索引时加 background:true 的选项，让创建工作在后台执行")]),s._v(" "),a("h3",{attrs:{id:"_1、查看集合索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、查看集合索引"}},[s._v("#")]),s._v(" 1、查看集合索引")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.col.getIndexes()\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_2、查看集合索引大小"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、查看集合索引大小"}},[s._v("#")]),s._v(" 2、查看集合索引大小")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.col.totalIndexSize()\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_3、删除集合所有索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、删除集合所有索引"}},[s._v("#")]),s._v(" 3、删除集合所有索引")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.col.dropIndexes()\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_4、删除集合指定索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、删除集合指定索引"}},[s._v("#")]),s._v(" 4、删除集合指定索引")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('db.col.dropIndex("索引名称")\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"mongodb-聚合"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mongodb-聚合"}},[s._v("#")]),s._v(" MongoDB 聚合")]),s._v(" "),a("p",[s._v("MongoDB 中聚合(aggregate)主要用于处理数据(诸如统计平均值，求和等)，并返回计算后的数据结果。")]),s._v(" "),a("p",[s._v("有点类似 SQL 语句中的 "),a("code",[s._v("count(*)")]),s._v("。")]),s._v(" "),a("h2",{attrs:{id:"aggregate-方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#aggregate-方法"}},[s._v("#")]),s._v(" aggregate() 方法")]),s._v(" "),a("p",[s._v("MongoDB 中聚合的方法使用 aggregate()。")]),s._v(" "),a("p",[s._v("语法\naggregate() 方法的基本语法格式如下所示：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(">db.COLLECTION_NAME.aggregate(AGGREGATE_OPERATION)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"实例-7"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例-7"}},[s._v("#")]),s._v(" 实例")]),s._v(" "),a("p",[s._v("集合中的数据如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('{\n        "_id" : ObjectId("613034ccca9da47b9eb3a80a"),\n        "title" : "PHP 教程",\n        "description" : "PHP 是一种创建动态交互性站点的强有力的服务器端脚本语言。",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "php"\n        ],\n        "likes" : 200\n}\n{\n        "_id" : ObjectId("613034e4ca9da47b9eb3a80b"),\n        "title" : "Java 教程",\n        "description" : "Java 是由Sun Microsystems公司于1995年5月推出的高级程序设计语言。",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "java"\n        ],\n        "likes" : 150\n}\n{\n        "_id" : ObjectId("613034ebca9da47b9eb3a80c"),\n        "title" : "MongoDB 教程",\n        "description" : "MongoDB 是一个 Nosql 数据库",\n        "by" : "菜鸟教程",\n        "url" : "http://www.runoob.com",\n        "tags" : [\n                "mongodb"\n        ],\n        "likes" : 100\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br")])]),a("p",[s._v("现在我们通过以上集合计算每个作者所写的文章数，使用 aggregate()计算结果如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('> db.col.aggregate([{$group : {_id : "$by", num_tutorial : {$sum : 1}}}]).pretty()\n{ "_id" : "菜鸟教程", "num_tutorial" : 3 }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("以上实例类似 sql 语句：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" select by, count(*) from col group by by\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("在上面的例子中，我们通过字段 by_user 字段对数据进行分组，并计算 by_user 字段相同值的总和。")]),s._v(" "),a("p",[s._v("下表展示了一些聚合的表达式:")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("表达式")]),s._v(" "),a("th",[s._v("描述")]),s._v(" "),a("th",[s._v("实例")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("$sum")]),s._v(" "),a("td",[s._v("计算总和。")]),s._v(" "),a("td",[s._v('db.mycol.aggregate([{$group : {_id : "$by_user", num_tutorial : {$sum : "$likes"}}}])')])]),s._v(" "),a("tr",[a("td",[s._v("$avg")]),s._v(" "),a("td",[s._v("计算平均值")]),s._v(" "),a("td",[s._v('db.mycol.aggregate([{$group : {_id : "$by_user", num_tutorial : {$avg : "$likes"}}}])')])]),s._v(" "),a("tr",[a("td",[s._v("$min")]),s._v(" "),a("td",[s._v("获取集合中所有文档对应值得最小值。")]),s._v(" "),a("td",[s._v('db.mycol.aggregate([{$group : {_id : "$by_user", num_tutorial : {$min : "$likes"}}}])')])]),s._v(" "),a("tr",[a("td",[s._v("$max")]),s._v(" "),a("td",[s._v("获取集合中所有文档对应值得最大值。")]),s._v(" "),a("td",[s._v('db.mycol.aggregate([{$group : {_id : "$by_user", num_tutorial : {$max : "$likes"}}}])')])]),s._v(" "),a("tr",[a("td",[s._v("$push")]),s._v(" "),a("td",[s._v("在结果文档中插入值到一个数组中。")]),s._v(" "),a("td",[s._v('db.mycol.aggregate([{$group : {_id : "$by_user", url : {$push: "$url"}}}])')])]),s._v(" "),a("tr",[a("td",[s._v("$addToSet")]),s._v(" "),a("td",[s._v("在结果文档中插入值到一个数组中，但不创建副本。")]),s._v(" "),a("td",[s._v('db.mycol.aggregate([{$group : {_id : "$by_user", url : {$addToSet : "$url"}}}])')])]),s._v(" "),a("tr",[a("td",[s._v("$first")]),s._v(" "),a("td",[s._v("根据资源文档的排序获取第一个文档数据。")]),s._v(" "),a("td",[s._v('db.mycol.aggregate([{$group : {_id : "$by_user", first_url : {$first : "$url"}}}])')])]),s._v(" "),a("tr",[a("td",[s._v("$last")]),s._v(" "),a("td",[s._v("根据资源文档的排序获取最后一个文档数据")]),s._v(" "),a("td",[s._v('db.mycol.aggregate([{$group : {_id : "$by_user", last_url : {$last : "$url"}}}])')])])])]),s._v(" "),a("h2",{attrs:{id:"管道的概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#管道的概念"}},[s._v("#")]),s._v(" 管道的概念")]),s._v(" "),a("p",[s._v("管道在 Unix 和 Linux 中一般用于将当前命令的输出结果作为下一个命令的参数。")]),s._v(" "),a("p",[s._v("MongoDB 的聚合管道将 MongoDB 文档在一个管道处理完毕后将结果传递给下一个管道处理。管道操作是可以重复的。")]),s._v(" "),a("p",[s._v("表达式：处理输入文档并输出。表达式是无状态的，只能用于计算当前聚合管道的文档，不能处理其它的文档。")]),s._v(" "),a("p",[s._v("这里我们介绍一下聚合框架中常用的几个操作：")]),s._v(" "),a("ul",[a("li",[s._v("$project：修改输入文档的结构。可以用来重命名、增加或删除域，也可以用于创建计算结果以及嵌套文档。")]),s._v(" "),a("li",[s._v("$match：用于过滤数据，只输出符合条件的文档。$match 使用 MongoDB 的标准查询操作。")]),s._v(" "),a("li",[s._v("$limit：用来限制 MongoDB 聚合管道返回的文档数。")]),s._v(" "),a("li",[s._v("$skip：在聚合管道中跳过指定数量的文档，并返回余下的文档。")]),s._v(" "),a("li",[s._v("$unwind：将文档中的某一个数组类型字段拆分成多条，每条包含数组中的一个值。")]),s._v(" "),a("li",[s._v("$group：将集合中的文档分组，可用于统计结果。")]),s._v(" "),a("li",[s._v("$sort：将输入文档排序后输出。")]),s._v(" "),a("li",[s._v("$geoNear：输出接近某一地理位置的有序文档。")])]),s._v(" "),a("h2",{attrs:{id:"管道操作符实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#管道操作符实例"}},[s._v("#")]),s._v(" 管道操作符实例")]),s._v(" "),a("p",[s._v("1、$project 实例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.article.aggregate(\n    { $project : {\n        title : 1 ,\n        author : 1 ,\n    }}\n );\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("这样的话结果中就只还有_id,tilte 和 author 三个字段了，默认情况下_id 字段是被包含的，如果要想不包含_id 话可以这样:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.article.aggregate(\n    { $project : {\n        _id : 0 ,\n        title : 1 ,\n        author : 1\n    }});\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("2.$match 实例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.articles.aggregate( [\n                        { $match : { score : { $gt : 70, $lte : 90 } } },\n                        { $group: { _id: null, count: { $sum: 1 } } }\n                       ] );\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("$match用于获取分数大于70小于或等于90记录，然后将符合条件的记录送到下一阶段$group 管道操作符进行处理。")]),s._v(" "),a("p",[s._v("3.$skip 实例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("db.article.aggregate(\n    { $skip : 5 });\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v('经过$skip 管道操作符处理后，前五个文档被"过滤"掉。')])])}),[],!1,null,null,null);n.default=t.exports}}]);